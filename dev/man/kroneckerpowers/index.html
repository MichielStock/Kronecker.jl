<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Kronecker powers and graphs · Kronecker.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>Kronecker.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../../">Kronecker.jl</a></li><li><a class="toctext" href="../basic/">Basic use</a></li><li><a class="toctext" href="../factorization/">Factorization methods</a></li><li><a class="toctext" href="../indexed/">Indexed Kronecker products</a></li><li class="current"><a class="toctext" href>Kronecker powers and graphs</a><ul class="internal"><li><a class="toctext" href="#Kronecker-powers-1">Kronecker powers</a></li><li><a class="toctext" href="#Kronecker-graphs-1">Kronecker graphs</a></li></ul></li><li><a class="toctext" href="../kroneckersums/">Kronecker sums</a></li><li><a class="toctext" href="../multiplication/">Multiplication</a></li><li><a class="toctext" href="../types/">Types</a></li></ul></nav><article id="docs"><header><nav><ul><li><a href>Kronecker powers and graphs</a></li></ul><a class="edit-page" href="https://github.com/MichielStock/Kronecker.jl/blob/master/docs/src/man/kroneckerpowers.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Kronecker powers and graphs</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Kronecker-powers-and-graphs-1" href="#Kronecker-powers-and-graphs-1">Kronecker powers and graphs</a></h1><h2><a class="nav-anchor" id="Kronecker-powers-1" href="#Kronecker-powers-1">Kronecker powers</a></h2><p>Repeated Kronecker multiplications of the same matrix, i.e.</p><div>\[A^{\otimes n}=\otimes_{i=1}^n A = \underbrace{A \otimes A \otimes \ldots \otimes A}_{n\text{ times}}\,.\]</div><p>Kronecker powers are supported using <code>kronecker(A, n)</code> or, equivalently, <code>⊗(A, n)</code>. These functions yield an instance of <code>KroneckerPower</code>, as struct which holds the matrix and the power. It works just like instances of <code>KroneckerProduct</code>, but more efficient since only a single matrix has to be stored and manipulated. These products work as expected.</p><pre><code class="language-julia-repl">julia&gt; using Kronecker

julia&gt; A = rand(2, 2)
2×2 Array{Float64,2}:
 0.721065  0.902065
 0.137618  0.203185

julia&gt; K2 = A ⊗ 2
4×4 KroneckerPower{Array{Float64,2},2}:
 0.519935   0.650447   0.650447   0.81372
 0.0992316  0.146509   0.12414    0.183286
 0.0992316  0.12414    0.146509   0.183286
 0.0189387  0.0279619  0.0279619  0.041284

julia&gt; inv(K2)
4×4 KroneckerPower{Array{Float64,2},2}:
  82.5068  -366.3    -366.3     1626.23
 -55.8823   292.801   248.097  -1299.93
 -55.8823   248.097   292.801  -1299.93
  37.8494  -198.316  -198.316   1039.1

julia&gt; K12 = K2 ⊗ 6  # works recursively
4096×4096 KroneckerPower{KroneckerPower{Array{Float64,2},2},6}:
 0.0197557    0.0247147    0.0247147    …  0.232053    0.232053    0.290303
 0.00377045   0.00556684   0.0047169       0.0522687   0.0442883   0.065389
 0.00377045   0.0047169    0.00556684      0.0442883   0.0522687   0.065389
 0.000719606  0.00106245   0.00106245      0.00997569  0.00997569  0.0147285
 0.00377045   0.0047169    0.0047169       0.0522687   0.0522687   0.065389
 0.000719606  0.00106245   0.000900239  …  0.0117732   0.00997569  0.0147285
 0.000719606  0.000900239  0.00106245      0.00997569  0.0117732   0.0147285
 0.00013734   0.000202774  0.000202774     0.00224696  0.00224696  0.00331751
 0.00377045   0.0047169    0.0047169       0.0522687   0.0522687   0.065389
 0.000719606  0.00106245   0.000900239     0.0117732   0.00997569  0.0147285
 ⋮                                      ⋱                          ⋮
 2.41772e-10  3.56961e-10  3.56961e-10     1.48876e-8  1.48876e-8  2.19806e-8
 6.63748e-9   8.3036e-9    8.3036e-9       3.46313e-7  3.46313e-7  4.33244e-7
 1.26679e-9   1.87034e-9   1.58477e-9      7.80051e-8  6.60953e-8  9.75857e-8
 1.26679e-9   1.58477e-9   1.87034e-9   …  6.60953e-8  7.80051e-8  9.75857e-8
 2.41772e-10  3.56961e-10  3.56961e-10     1.48876e-8  1.48876e-8  2.19806e-8
 1.26679e-9   1.58477e-9   1.58477e-9      7.80051e-8  7.80051e-8  9.75857e-8
 2.41772e-10  3.56961e-10  3.0246e-10      1.75702e-8  1.48876e-8  2.19806e-8
 2.41772e-10  3.0246e-10   3.56961e-10     1.48876e-8  1.75702e-8  2.19806e-8
 4.61431e-11  6.81274e-11  6.81274e-11  …  3.35334e-9  3.35334e-9  4.951e-9

julia&gt; K12^2  # example
4096×4096 KroneckerPower{KroneckerPower{Array{Float64,2},2},6}:
 0.00509609   0.00659671   0.00659671   …  0.0871429    0.112804
 0.00100639   0.00130888   0.00130273      0.0172092    0.0223818
 0.00100639   0.00130273   0.00130888      0.0172904    0.0223818
 0.000198744  0.000258481  0.000258481     0.00341455   0.00444087
 0.00100639   0.00130273   0.00130273      0.0172904    0.0223818
 0.000198744  0.000258481  0.000257267  …  0.00341455   0.00444087
 0.000198744  0.000257267  0.000258481     0.00343066   0.00444087
 3.92484e-5   5.10455e-5   5.10455e-5      0.000677495  0.000881132
 0.00100639   0.00130273   0.00130273      0.0172904    0.0223818
 0.000198744  0.000258481  0.000257267     0.00341455   0.00444087
 ⋮                                      ⋱               ⋮
 9.07924e-11  1.18082e-10  1.18082e-10     1.62738e-9   2.11653e-9
 2.32805e-9   3.01358e-9   3.01358e-9      4.15324e-8   5.37623e-8
 4.59749e-10  5.97938e-10  5.9513e-10      8.20192e-9   1.06672e-8
 4.59749e-10  5.9513e-10   5.97938e-10  …  8.24063e-9   1.06672e-8
 9.07924e-11  1.18082e-10  1.18082e-10     1.62738e-9   2.11653e-9
 4.59749e-10  5.9513e-10   5.9513e-10      8.24063e-9   1.06672e-8
 9.07924e-11  1.18082e-10  1.17528e-10     1.62738e-9   2.11653e-9
 9.07924e-11  1.17528e-10  1.18082e-10     1.63506e-9   2.11653e-9
 1.79299e-11  2.33192e-11  2.33192e-11  …  3.22895e-10  4.19949e-10</code></pre><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Kronecker.kronecker-Tuple{AbstractArray{T,2} where T,Int64}" href="#Kronecker.kronecker-Tuple{AbstractArray{T,2} where T,Int64}"><code>Kronecker.kronecker</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">kronecker(A::AbstractMatrix, pow::Int)</code></pre><p>Kronecker power, computes <code>A ⊗ A ⊗ ... ⊗ A</code>. Returns a lazy <code>KroneckerPower</code> type.</p></div></div><a class="source-link" target="_blank" href="https://github.com/MichielStock/Kronecker.jl/blob/970b801b919670a6fd273a43d3dc18496b95b899/src/kroneckerpowers.jl#L25-L30">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Kronecker.:⊗-Tuple{AbstractArray{T,2} where T,Int64}" href="#Kronecker.:⊗-Tuple{AbstractArray{T,2} where T,Int64}"><code>Kronecker.:⊗</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">⊗(A::AbstractMatrix, pow::Int)</code></pre><p>Kronecker power, computes <code>A ⊗ A ⊗ ... ⊗ A</code>. Returns a lazy <code>KroneckerPower</code> type.</p></div></div><a class="source-link" target="_blank" href="https://github.com/MichielStock/Kronecker.jl/blob/970b801b919670a6fd273a43d3dc18496b95b899/src/kroneckerpowers.jl#L33-L38">source</a></section><h2><a class="nav-anchor" id="Kronecker-graphs-1" href="#Kronecker-graphs-1">Kronecker graphs</a></h2><p>An exciting application of Kronecker powers (or Krocker products in general) is generating large, realistic graphs from an initial &#39;seed&#39; via a stochastic process. This is called a Kronecker graph and is described in detail in <a href="https://cs.stanford.edu/~jure/pubs/kronecker-jmlr10.pdf">Leskovec et al. (2008)</a>.</p><p>If we use an initial matrix <span>$P$</span> with values in <span>$[0,1]$</span> as a seed, then <span>$P_n=P^{\otimes n}$</span> can be seen as a probability distribution for an adjacency matrix of a graph. The elements <span>$(P_n)_{i,j}$</span> give the probabilities that there is an edge from node <span>$i$</span> to node <span>$j$</span>. Leskovec and co-authors give two algorithms for sampling adjacency matrices from this distribution, both provided by <code>Kronecker.jl</code>:</p><ul><li><code>naivesample</code> gives exact samples, but has a computational time proportional to the number of elements and hence prohibitive for large graphs;</li><li><code>fastsample</code> a recursive heuristic, has a computational time proportional to the expected number of edges in the graph.</li></ul><p>The latter can easily scale to generate graphs of millions of nodes. Both return the adjacency matrix as a sparse array.</p><pre><code class="language-julia-repl">julia&gt; using Kronecker

julia&gt; P = rand(2, 2)
2×2 Array{Float64,2}:
 0.747713  0.290982
 0.735744  0.681465

julia&gt; P10 = P ⊗ 10
1024×1024 KroneckerPower{Array{Float64,2},10}:
 0.0546196  0.0212559  0.0212559  …  1.11822e-5  1.11822e-5  4.35168e-6
 0.0537453  0.0497803  0.0209157     2.61881e-5  1.10032e-5  1.01914e-5
 0.0537453  0.0209157  0.0497803     1.10032e-5  2.61881e-5  1.01914e-5
 0.0528851  0.0489835  0.0489835     2.57689e-5  2.57689e-5  2.38678e-5
 0.0537453  0.0209157  0.0209157     2.61881e-5  2.61881e-5  1.01914e-5
 0.0528851  0.0489835  0.0205809  …  6.13312e-5  2.57689e-5  2.38678e-5
 0.0528851  0.0205809  0.0489835     2.57689e-5  6.13312e-5  2.38678e-5
 0.0520385  0.0481994  0.0481994     6.03495e-5  6.03495e-5  5.58972e-5
 0.0537453  0.0209157  0.0209157     2.61881e-5  2.61881e-5  1.01914e-5
 0.0528851  0.0489835  0.0205809     6.13312e-5  2.57689e-5  2.38678e-5
 ⋮                                ⋱
 0.0472365  0.0437517  0.0437517  …  0.0099573   0.0099573   0.0092227
 0.0487858  0.0189856  0.0189856     0.00432087  0.00432087  0.00168152
 0.0480049  0.0444634  0.0186817     0.0101193   0.00425171  0.00393804
 0.0480049  0.0186817  0.0444634     0.00425171  0.0101193   0.00393804
 0.0472365  0.0437517  0.0437517     0.0099573   0.0099573   0.0092227
 0.0480049  0.0186817  0.0186817  …  0.0101193   0.0101193   0.00393804
 0.0472365  0.0437517  0.0183827     0.0236989   0.0099573   0.0092227
 0.0472365  0.0183827  0.0437517     0.0099573   0.0236989   0.0092227
 0.0464804  0.0430514  0.0430514     0.0233195   0.0233195   0.0215991

julia&gt; sum(P10)  # expected number of edges
7982.0444387616735

julia&gt; A = fastsample(P10)
1024×1024 SparseArrays.SparseMatrixCSC{Bool,Int64} with 7899 stored entries:
  [32  ,    1]  =  true
  [33  ,    1]  =  true
  [48  ,    1]  =  true
  [55  ,    1]  =  true
  [78  ,    1]  =  true
  [93  ,    1]  =  true
  [135 ,    1]  =  true
  [163 ,    1]  =  true
  [186 ,    1]  =  true
  ⋮
  [765 , 1017]  =  true
  [934 , 1017]  =  true
  [935 , 1017]  =  true
  [987 , 1017]  =  true
  [425 , 1018]  =  true
  [492 , 1019]  =  true
  [937 , 1019]  =  true
  [512 , 1020]  =  true
  [704 , 1024]  =  true</code></pre><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Kronecker.isprob" href="#Kronecker.isprob"><code>Kronecker.isprob</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">isprob(A::AbstractArray)</code></pre><p>Test if a matrix can be interpeted as a probability matrix, i.e., all elements are between 0 and 1.</p></div></div><a class="source-link" target="_blank" href="https://github.com/MichielStock/Kronecker.jl/blob/970b801b919670a6fd273a43d3dc18496b95b899/src/kroneckergraphs.jl#L19-L24">source</a><div><div><pre><code class="language-none">isprob(K::AbstractKroneckerProduct)</code></pre><p>Test if a Kronecker product can be interpeted as a probability matrix, i.e., all elements are between 0 and 1.</p></div></div><a class="source-link" target="_blank" href="https://github.com/MichielStock/Kronecker.jl/blob/970b801b919670a6fd273a43d3dc18496b95b899/src/kroneckergraphs.jl#L27-L32">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Kronecker.naivesample" href="#Kronecker.naivesample"><code>Kronecker.naivesample</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">naivesample(P::AbstractKroneckerProduct)</code></pre><p>Sample a Kronecker graph from a probabilistic Kronecker product P using the naive method. This method has a time complexity in the size of the Kronecker product (but is still light in memory use). Consider using <code>fastsample</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/MichielStock/Kronecker.jl/blob/970b801b919670a6fd273a43d3dc18496b95b899/src/kroneckergraphs.jl#L38-L44">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Kronecker.fastsample" href="#Kronecker.fastsample"><code>Kronecker.fastsample</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">fastsample(P::AbstractKroneckerProduct)</code></pre><p>Uses the heuristic sampling from Leskovec et al. (2008) to sample a large Kronecker graph.</p></div></div><a class="source-link" target="_blank" href="https://github.com/MichielStock/Kronecker.jl/blob/970b801b919670a6fd273a43d3dc18496b95b899/src/kroneckergraphs.jl#L87-L92">source</a></section><footer><hr/><a class="previous" href="../indexed/"><span class="direction">Previous</span><span class="title">Indexed Kronecker products</span></a><a class="next" href="../kroneckersums/"><span class="direction">Next</span><span class="title">Kronecker sums</span></a></footer></article></body></html>
