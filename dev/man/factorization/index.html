<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Factorization methods · Kronecker.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../basic/">Kronecker.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../basic/">Basic use</a></li><li><a class="tocitem" href="../types/">Types</a></li><li><a class="tocitem" href="../multiplication/">Multiplication</a></li><li class="is-active"><a class="tocitem" href>Factorization methods</a><ul class="internal"><li><a class="tocitem" href="#Eigenvalue-decomposition"><span>Eigenvalue decomposition</span></a></li><li><a class="tocitem" href="#Cholesky-factorization"><span>Cholesky factorization</span></a></li></ul></li><li><a class="tocitem" href="../indexed/">Indexed Kronecker products</a></li><li><a class="tocitem" href="../kroneckersums/">Kronecker sums</a></li><li><a class="tocitem" href="../kroneckerpowers/">Kronecker powers and graphs</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Factorization methods</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Factorization methods</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/MichielStock/Kronecker.jl/blob/master/docs/src/man/factorization.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Factorization-methods"><a class="docs-heading-anchor" href="#Factorization-methods">Factorization methods</a><a id="Factorization-methods-1"></a><a class="docs-heading-anchor-permalink" href="#Factorization-methods" title="Permalink"></a></h1><p>Many forms of matrix factorization such as eigenvalue decomposition, LU factorization, Cholesky factorization etc., can be computed efficiently. The decomposition of the Kronecker product is the Kronecker product of the decompositions. We have overloaded some of the factorization functions from <code>LinearAlgebra</code> to compute the factorization of instances of <code>AbstractKroneckerProduct</code>.</p><h2 id="Eigenvalue-decomposition"><a class="docs-heading-anchor" href="#Eigenvalue-decomposition">Eigenvalue decomposition</a><a id="Eigenvalue-decomposition-1"></a><a class="docs-heading-anchor-permalink" href="#Eigenvalue-decomposition" title="Permalink"></a></h2><p>The function <code>eigen</code> of <code>LinearAlgebra</code> is overloaded to compute the decomposition of <code>AbstractKroneckerProduct</code>s. The result is a factorization of the <code>Eigen</code> type, containing a vector of the eigenvalues and a matrix with the eigenvectors. Just like long-time users would expect! The eigenvectors are structured as Kronecker products and can be processed accordingly.</p><p>The functions <code>det</code>, <code>logdet</code>, <code>inv</code> and <code>\</code> are overloaded the make use of this decomposition.</p><p>The eigenvalue decomposition of matrices can be used to solve large systems of the form:</p><p class="math-container">\[(A \otimes B + c\cdot I) \mathbf{x} = \mathbf{b}\]</p><p>The case where <span>$A$</span> and <span>$B$</span> are positive semi-definite frequently occurs in machine learning, for example in ridge regression.</p><pre><code class="language-julia-repl">
julia&gt; A, B = rand(10, 10), randn(4, 4);

julia&gt; As, Bs = (A, B) .|&gt; X -&gt; X * X&#39;;  # make positive definite

julia&gt; K = As ⊗ Bs
40×40 Kronecker.KroneckerProduct{Float64,Array{Float64,2},Array{Float64,2}}:
  17.6275   -11.5504   -9.64097   …  -9.30654  -7.76803   -10.7905
 -11.5504    36.7548    7.01271      29.6145    5.65036    12.1232
  -9.64097    7.01271  13.9532        5.65036  11.2425      0.278026
 -13.3922    15.0463    0.345061     12.1232    0.278026   37.3738
  12.0406    -7.88958  -6.58532      -8.04833  -6.71783    -9.33167
  -7.88958   25.1056    4.79007   …  25.6107    4.88645    10.4842
  -6.58532    4.79007   9.53078       4.88645   9.72256     0.240438
  -9.1476    10.2774    0.235696     10.4842    0.240438   32.321
  12.4449    -8.15456  -6.80649      -6.8646   -5.72978    -7.95919
  -8.15456   25.9488    4.95095      21.844     4.16777     8.94223
   ⋮                              ⋱
  -5.93156    6.66416   0.152831      5.15356   0.118188   15.8875
  12.7655    -8.36461  -6.98182      -6.56158  -5.47686    -7.60785
  -8.36461   26.6172    5.07848      20.8797    3.98379     8.5475
  -6.98182    5.07848  10.1046        3.98379   7.92653     0.196023
  -9.69838   10.8962    0.249887  …   8.5475    0.196023   26.3504
  14.203     -9.30654  -7.76803      -9.98385  -8.33338   -11.5758
  -9.30654   29.6145    5.65036      31.7698    6.06158    13.0055
  -7.76803    5.65036  11.2425        6.06158  12.0607      0.29826
 -10.7905    12.1232    0.278026     13.0055    0.29826    40.0938

julia&gt; E = eigen(K)
Eigen{Float64,Float64,Kronecker.KroneckerProduct{Float64,Array{Float64,2},Array{Float64,2}},Array{Float64,1}}
values:
40-element Array{Float64,1}:
   0.00045704423995791116
   0.0018587559214928069
   0.003159089979229802
   0.007218707745456753
   0.025536967810513886
   0.10385644536103349
   0.17651153226991242
   0.40333930769199156
   0.05554654546321358
   0.22590257413095421
   ⋮
  20.997800854100877
   1.8194688997900135
   7.399608825106582
  12.576169802241072
  28.73729300415506
  24.048403225348242
  97.80259324935187
 166.2225732298287
 379.8284267725922
vectors:
40×40 Kronecker.KroneckerProduct{Float64,Array{Float64,2},Array{Float64,2}}:
 -0.391872     -0.323545     …  -0.231296    -0.0742052  -0.148036
 -0.00164117   -0.309885        -0.221531     0.242813    0.226634
 -0.379222      0.333374         0.238322     0.159424    0.0607483
 -0.12052       0.00725333       0.00518527  -0.263663    0.287107
 -0.0887687    -0.073291        -0.186582    -0.0598598  -0.119417
 -0.000371766  -0.0701966    …  -0.178704     0.195872    0.182821
 -0.0859032     0.0755174        0.19225      0.128604    0.0490044
 -0.0273007     0.00164306       0.00418285  -0.212691    0.231603
  0.0285196     0.0235469       -0.171028    -0.0548697  -0.109462
  0.000119441   0.0225528       -0.163807     0.179543    0.167581
  ⋮                          ⋱
  0.107231     -0.00645358       0.00238474  -0.12126     0.132042
  0.0177784     0.0146785       -0.16526     -0.0530191  -0.105771
  7.44564e-5    0.0140588       -0.158282     0.173488    0.161929
  0.0172045    -0.0151244        0.17028      0.113907    0.0434042
  0.00546771   -0.000329068  …   0.00370484  -0.188385    0.205136
  0.214634      0.177211        -0.210394    -0.0674993  -0.134658
  0.000898897   0.169729        -0.201511     0.220869    0.206153
  0.207706     -0.182594         0.216785     0.145017    0.0552584
  0.0660105    -0.00397276       0.00471667  -0.239836    0.261161

julia&gt; logdet(E)
8.428651543130142

julia&gt; b = randn(40);

julia&gt; (E + 0.1I) \ b  # solve a system
40-element Array{Float64,1}:
 -4.038420106208041
 -7.852692343902399
 -3.8833407649950065
 -0.21201113815774605
 -0.39901712269430734
 -0.5909757360526172
 -1.0095077370581034
 -1.2538088718774167
 -0.9796386824815213
  1.2293335305508013
  ⋮
  8.211387812126697
 -0.1814214163423546
  2.143446149217612
 -0.5953402365221909
 -2.394976138958853
  5.498579196747583
  1.1390707667961317
  3.29883708881446
  6.82839987175902</code></pre><article class="docstring"><header><a class="docstring-binding" id="LinearAlgebra.eigen" href="#LinearAlgebra.eigen"><code>LinearAlgebra.eigen</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">eigen(K::AbstractKroneckerProduct)</code></pre><p>Wrapper around <code>eigen</code> from the <code>LinearAlgebra</code> package. If the matrices of an <code>AbstractKroneckerProduct</code> instance are square, performs Eigenvalue decompositon on them and returns an <code>Eigen</code> type. Otherwise, it collects the instance and runs eigen on the full matrix. The functions, <code>\</code>, <code>inv</code>, and <code>logdet</code> are overloaded to efficiently work with this type.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MichielStock/Kronecker.jl/blob/08c40e247d0ad3356f5eb373efdcf33bf885e36a/src/eigen.jl#L5-L14">source</a></section></article><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>+(E::Eigen, B::UniformScaling)</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>+(::Eigen, ::UniformScaling)</code>. Check Documenter&#39;s build log for details.</p></div></div><article class="docstring"><header><a class="docstring-binding" id="LinearAlgebra.det-Tuple{Eigen{var&quot;#s5&quot;,var&quot;#s3&quot;,var&quot;#s2&quot;,U} where U&lt;:(AbstractArray{T,1} where T) where var&quot;#s2&quot;&lt;:AbstractKroneckerProduct where var&quot;#s3&quot;&lt;:Number where var&quot;#s5&quot;&lt;:Number}" href="#LinearAlgebra.det-Tuple{Eigen{var&quot;#s5&quot;,var&quot;#s3&quot;,var&quot;#s2&quot;,U} where U&lt;:(AbstractArray{T,1} where T) where var&quot;#s2&quot;&lt;:AbstractKroneckerProduct where var&quot;#s3&quot;&lt;:Number where var&quot;#s5&quot;&lt;:Number}"><code>LinearAlgebra.det</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">det(K::AbstractKroneckerProduct)</code></pre><p>Compute the determinant of a Kronecker product.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MichielStock/Kronecker.jl/blob/08c40e247d0ad3356f5eb373efdcf33bf885e36a/src/base.jl#L206-L210">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LinearAlgebra.logdet-Tuple{Eigen{var&quot;#s5&quot;,var&quot;#s3&quot;,var&quot;#s2&quot;,U} where U&lt;:(AbstractArray{T,1} where T) where var&quot;#s2&quot;&lt;:AbstractKroneckerProduct where var&quot;#s3&quot;&lt;:Number where var&quot;#s5&quot;&lt;:Number}" href="#LinearAlgebra.logdet-Tuple{Eigen{var&quot;#s5&quot;,var&quot;#s3&quot;,var&quot;#s2&quot;,U} where U&lt;:(AbstractArray{T,1} where T) where var&quot;#s2&quot;&lt;:AbstractKroneckerProduct where var&quot;#s3&quot;&lt;:Number where var&quot;#s5&quot;&lt;:Number}"><code>LinearAlgebra.logdet</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">logdet(K::Eigen)</code></pre><p>Compute the logarithm of the determinant of the eigenvalue decomp of aKronecker product.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MichielStock/Kronecker.jl/blob/08c40e247d0ad3356f5eb373efdcf33bf885e36a/src/eigen.jl#L46-L51">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.inv-Tuple{Eigen{var&quot;#s5&quot;,var&quot;#s3&quot;,var&quot;#s2&quot;,U} where U&lt;:(AbstractArray{T,1} where T) where var&quot;#s2&quot;&lt;:AbstractKroneckerProduct where var&quot;#s3&quot;&lt;:Number where var&quot;#s5&quot;&lt;:Number}" href="#Base.inv-Tuple{Eigen{var&quot;#s5&quot;,var&quot;#s3&quot;,var&quot;#s2&quot;,U} where U&lt;:(AbstractArray{T,1} where T) where var&quot;#s2&quot;&lt;:AbstractKroneckerProduct where var&quot;#s3&quot;&lt;:Number where var&quot;#s5&quot;&lt;:Number}"><code>Base.inv</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">inv(K::Eigen)</code></pre><p>Compute the inverse of the eigenvalue decomp of aKronecker product. Returns another type of <code>Eigen</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MichielStock/Kronecker.jl/blob/08c40e247d0ad3356f5eb373efdcf33bf885e36a/src/eigen.jl#L54-L59">source</a></section></article><h2 id="Cholesky-factorization"><a class="docs-heading-anchor" href="#Cholesky-factorization">Cholesky factorization</a><a id="Cholesky-factorization-1"></a><a class="docs-heading-anchor-permalink" href="#Cholesky-factorization" title="Permalink"></a></h2><p>Similar to the eigenvalue decomposition, <code>cholesky</code> has been overloaded to allow for efficient Cholesky decomposition of Kronecker products of symmetric and positive definite matrices.</p><pre><code class="language-julia-repl">
julia&gt; A, B = rand(10, 10), randn(4, 4);

julia&gt; As, Bs = (A, B) .|&gt; X -&gt; X * X&#39;;  # make positive definite

julia&gt; K = As ⊗ Bs
40×40 Kronecker.KroneckerProduct{Float64,Array{Float64,2},Array{Float64,2}}:
  8.69734   -1.01003   -3.78375    …  -0.772891  -2.89538    -2.81243
 -1.01003   18.4047     8.09634       14.0835     6.19544    -4.78257
 -3.78375    8.09634    5.12089        6.19544    3.91858     0.0353986
 -3.67535   -6.24998    0.0462598     -4.78257    0.0353986   7.45578
  8.81838   -1.02409   -3.83641       -0.586293  -2.19635    -2.13343
 -1.02409   18.6608     8.20902    …  10.6834     4.69968    -3.62793
 -3.83641    8.20902    5.19216        4.69968    2.97252     0.0268524
 -3.7265    -6.33696    0.0469036     -3.62793    0.0268524   5.65575
  7.38794   -0.857969  -3.2141        -0.794308  -2.97561    -2.89037
 -0.857969  15.6338     6.87742       14.4738     6.36712    -4.9151
  ⋮                                ⋱
 -3.70939   -6.30785    0.0466882     -4.11027    0.0304226   6.4077
  7.21819   -0.838256  -3.14025       -0.422445  -1.58255    -1.53721
 -0.838256  15.2746     6.7194         7.69774    3.38629    -2.61405
 -3.14025    6.7194     4.24999        3.38629    2.14181     0.0193481
 -3.05029   -5.18705    0.0383924  …  -2.61405    0.0193481   4.07517
  6.65533   -0.772891  -2.89538       -0.925925  -3.46867    -3.3693
 -0.772891  14.0835     6.19544       16.8721     7.42215    -5.72953
 -2.89538    6.19544    3.91858        7.42215    4.69447     0.0424077
 -2.81243   -4.78257    0.0353986     -5.72953    0.0424077   8.93204

julia&gt; C = cholesky(K)
40×40 CholeskyKronecker{Cholesky{Float64,Array{Float64,2}},Cholesky{Float64,Array{Float64,2}}}
U factor:
40×40 Kronecker.KroneckerProduct{Float64,UpperTriangular{Float64,Array{Float64,2}},UpperTriangular{Float64,Array{Float64,2}}}:
 2.94913  -0.342485  -1.28301   …  -0.262074   -0.981776   -0.953649
 0.0       4.27638    1.79052       3.27234     1.37013    -1.19475
 0.0       0.0        0.518482      0.0         0.39675     1.83435
 0.0       0.0        0.0           0.0         0.0         0.0598278
 0.0      -0.0       -0.0           0.117613    0.440598    0.427975
 0.0       0.0        0.0       …  -1.46855    -0.614882    0.536174
 0.0       0.0        0.0          -0.0        -0.178052   -0.823212
 0.0       0.0        0.0          -0.0        -0.0        -0.0268493
 0.0      -0.0       -0.0          -0.0217454  -0.0814621  -0.0791283
 0.0       0.0        0.0           0.27152     0.113686   -0.0991331
 ⋮                              ⋱
 0.0       0.0        0.0          -0.0        -0.0        -0.0138373
 0.0      -0.0       -0.0           0.125529    0.470254    0.456782
 0.0       0.0        0.0          -1.5674     -0.65627     0.572264
 0.0       0.0        0.0          -0.0        -0.190037   -0.878622
 0.0       0.0        0.0       …  -0.0        -0.0        -0.0286565
 0.0      -0.0       -0.0          -0.0331629  -0.124234   -0.120675
 0.0       0.0        0.0           0.414082    0.173376   -0.151183
 0.0       0.0        0.0           0.0         0.0502047   0.232118
 0.0       0.0        0.0           0.0         0.0         0.00757061

julia&gt; logdet(C)
-99.04748159940002

julia&gt; inv(C)
40×40 Kronecker.KroneckerProduct{Float64,Array{Float64,2},Array{Float64,2}}:
   32732.4         -56921.7        …  -91074.9         19670.3
  -56921.7          99063.2                1.58476e5  -34245.9
       1.14404e5       -1.9907e5          -3.1849e5    68812.8
  -24708.9          43018.3            68812.8        -14883.5
   90529.0        -157430.0               -3.99023e5   86180.4
 -157430.0              2.73982e5  …       6.94322e5      -1.5004e5
       3.16411e5  -550574.0               -1.39539e6       3.01486e5
  -68338.2              1.18977e5          3.01486e5  -65208.3
   36279.7         -63090.4               -1.71648e5   37072.4
  -63090.4              1.09799e5          2.98678e5  -64543.1
       ⋮                           ⋱
   -3884.72          6763.3            15082.9         -3262.26
      -1.03304e5   179645.0                4.34176e5  -93772.9
  179645.0             -3.12643e5         -7.55492e5       1.63259e5
      -3.6106e5         6.28266e5          1.51832e6      -3.28047e5
   77981.4             -1.35766e5  …      -3.28047e5   70953.1
  -26057.6          45314.2                1.06766e5  -23059.2
   45314.2         -78862.1               -1.85779e5   40146.0
  -91074.9              1.58476e5          3.73361e5  -80668.3
   19670.3         -34245.9           -80668.3         17447.7</code></pre><article class="docstring"><header><a class="docstring-binding" id="LinearAlgebra.cholesky" href="#LinearAlgebra.cholesky"><code>LinearAlgebra.cholesky</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">cholesky(K::AbstractKroneckerProduct; check = true)</code></pre><p>Wrapper around <code>cholesky</code> from the <code>LinearAlgebra</code> package. Performs Cholesky on the matrices of a <code>AbstractKroneckerProduct</code> instances and returns a <code>CholeskyKronecker</code> type. Similar to <code>Cholesky</code>, <code>size</code>, <code>\</code>, <code>inv</code>, <code>det</code>, and <code>logdet</code> are overloaded to efficiently work with this type.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MichielStock/Kronecker.jl/blob/08c40e247d0ad3356f5eb373efdcf33bf885e36a/src/factorization.jl#L42-L49">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../multiplication/">« Multiplication</a><a class="docs-footer-nextpage" href="../indexed/">Indexed Kronecker products »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.3 on <span class="colophon-date" title="Wednesday 14 July 2021 11:12">Wednesday 14 July 2021</span>. Using Julia version 1.5.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
