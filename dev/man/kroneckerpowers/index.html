<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Kronecker powers and graphs · Kronecker.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>Kronecker.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../../">Kronecker.jl</a></li><li><a class="toctext" href="../basic/">Basic use</a></li><li><a class="toctext" href="../factorization/">Factorization methods</a></li><li><a class="toctext" href="../indexed/">Indexed Kronecker products</a></li><li class="current"><a class="toctext" href>Kronecker powers and graphs</a><ul class="internal"><li><a class="toctext" href="#Kronecker-powers-1">Kronecker powers</a></li><li><a class="toctext" href="#Kronecker-graphs-1">Kronecker graphs</a></li></ul></li><li><a class="toctext" href="../kroneckersums/">Kronecker sums</a></li><li><a class="toctext" href="../multiplication/">Multiplication</a></li><li><a class="toctext" href="../types/">Types</a></li></ul></nav><article id="docs"><header><nav><ul><li><a href>Kronecker powers and graphs</a></li></ul><a class="edit-page" href="https://github.com/MichielStock/Kronecker.jl/blob/master/docs/src/man/kroneckerpowers.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Kronecker powers and graphs</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Kronecker-powers-and-graphs-1" href="#Kronecker-powers-and-graphs-1">Kronecker powers and graphs</a></h1><h2><a class="nav-anchor" id="Kronecker-powers-1" href="#Kronecker-powers-1">Kronecker powers</a></h2><p>Repeated Kronecker multiplications of the same matrix, i.e.</p><div>\[A^{\otimes n}=\otimes_{i=1}^n A = \underbrace{A \otimes A \otimes \ldots \otimes A}_{n\text{ times}}\,.\]</div><p>Kronecker powers are supported using <code>kronecker(A, n)</code> or, equivalently, <code>⊗(A, n)</code>. These functions yield an instance of <code>KroneckerPower</code>, as struct which holds the matrix and the power. It works just like instances of <code>KroneckerProduct</code>, but more efficient since only a single matrix has to be stored and manipulated. These products work as expected.</p><pre><code class="language-julia-repl">julia&gt; using Kronecker

julia&gt; A = rand(2, 2)
2×2 Array{Float64,2}:
 0.198876  0.5898
 0.547157  0.675269

julia&gt; K2 = A ⊗ 2
4×4 KroneckerPower{Array{Float64,2},2}:
 0.0395515  0.117297  0.117297  0.347865
 0.108816   0.134295  0.322714  0.398274
 0.108816   0.322714  0.134295  0.398274
 0.299381   0.369479  0.369479  0.455989

julia&gt; inv(K2)
4×4 KroneckerPower{Array{Float64,2},2}:
  12.8441   -11.2184   -11.2184    9.79853
 -10.4073     3.78276    9.09008  -3.30398
 -10.4073     9.09008    3.78276  -3.30398
   8.43286   -3.0651    -3.0651    1.11407

julia&gt; K12 = K2 ⊗ 6  # works recursively
4096×4096 KroneckerPower{KroneckerPower{Array{Float64,2},2},6}:
 3.82804e-9   1.13527e-8   1.13527e-8   …  0.000597499  0.00177199
 1.05319e-8   1.29979e-8   3.12342e-8      0.00164387   0.00202877
 1.05319e-8   3.12342e-8   1.29979e-8      0.000684083  0.00202877
 2.89759e-8   3.57604e-8   3.57604e-8      0.00188209   0.00232276
 1.05319e-8   3.12342e-8   3.12342e-8      0.000684083  0.00202877
 2.89759e-8   3.57604e-8   8.59333e-8   …  0.00188209   0.00232276
 2.89759e-8   8.59333e-8   3.57604e-8      0.000783215  0.00232276
 7.97202e-8   9.8386e-8    9.8386e-8       0.00215482   0.00265936
 1.05319e-8   3.12342e-8   3.12342e-8      0.000684083  0.00202877
 2.89759e-8   3.57604e-8   8.59333e-8      0.00188209   0.00232276
 ⋮                                      ⋱               ⋮
 0.000261707  0.000322983  0.000322983     0.00636192   0.00785151
 3.45743e-5   0.000102536  0.000102536     0.00201969   0.00598976
 9.51227e-5   0.000117395  0.000282103     0.00555669   0.00685774
 9.51227e-5   0.000282103  0.000117395  …  0.00231237   0.00685774
 0.000261707  0.000322983  0.000322983     0.00636192   0.00785151
 9.51227e-5   0.000282103  0.000282103     0.00231237   0.00685774
 0.000261707  0.000322983  0.000776138     0.00636192   0.00785151
 0.000261707  0.000776138  0.000322983     0.00264746   0.00785151
 0.000720022  0.000888609  0.000888609  …  0.00728384   0.00898929

julia&gt; K12^2  # example
4096×4096 KroneckerPower{KroneckerPower{Array{Float64,2},2},6}:
 5.10878e-6   7.27075e-6   7.27075e-6   …  0.000247856  0.000352746
 6.74507e-6   1.09815e-5   9.59949e-6      0.000327242  0.000532777
 6.74507e-6   9.59949e-6   1.09815e-5      0.000374355  0.000532777
 8.90544e-6   1.44988e-5   1.44988e-5      0.000494256  0.000804689
 6.74507e-6   9.59949e-6   9.59949e-6      0.000374355  0.000532777
 8.90544e-6   1.44988e-5   1.26741e-5   …  0.000494256  0.000804689
 8.90544e-6   1.26741e-5   1.44988e-5      0.000565413  0.000804689
 1.17578e-5   1.91426e-5   1.91426e-5      0.000746509  0.00121538
 6.74507e-6   9.59949e-6   9.59949e-6      0.000374355  0.000532777
 8.90544e-6   1.44988e-5   1.26741e-5      0.000494256  0.000804689
 ⋮                                      ⋱               ⋮
 0.000108562  0.000176748  0.000176748     0.0202162    0.0329136
 6.22787e-5   8.86343e-5   8.86343e-5      0.0101379    0.0144281
 8.2226e-5    0.00013387   0.000117023     0.0133849    0.0217917
 8.2226e-5    0.000117023  0.00013387   …  0.0153119    0.0217917
 0.000108562  0.000176748  0.000176748     0.0202162    0.0329136
 8.2226e-5    0.000117023  0.000117023     0.0153119    0.0217917
 0.000108562  0.000176748  0.000154504     0.0202162    0.0329136
 0.000108562  0.000154504  0.000176748     0.0231267    0.0329136
 0.000143333  0.000233358  0.000233358  …  0.0305339    0.0497116</code></pre><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Kronecker.kronecker-Tuple{AbstractArray{T,2} where T,Int64}" href="#Kronecker.kronecker-Tuple{AbstractArray{T,2} where T,Int64}"><code>Kronecker.kronecker</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">kronecker(A::AbstractMatrix, pow::Int)</code></pre><p>Kronecker power, computes <code>A ⊗ A ⊗ ... ⊗ A</code>. Returns a lazy <code>KroneckerPower</code> type.</p></div></div><a class="source-link" target="_blank" href="https://github.com/MichielStock/Kronecker.jl/blob/1b436cde2f17d8fbf6caa7143cd9e027654e2826/src/kroneckerpowers.jl#L25-L30">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Kronecker.:⊗-Tuple{AbstractArray{T,2} where T,Int64}" href="#Kronecker.:⊗-Tuple{AbstractArray{T,2} where T,Int64}"><code>Kronecker.:⊗</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">⊗(A::AbstractMatrix, pow::Int)</code></pre><p>Kronecker power, computes <code>A ⊗ A ⊗ ... ⊗ A</code>. Returns a lazy <code>KroneckerPower</code> type.</p></div></div><a class="source-link" target="_blank" href="https://github.com/MichielStock/Kronecker.jl/blob/1b436cde2f17d8fbf6caa7143cd9e027654e2826/src/kroneckerpowers.jl#L33-L38">source</a></section><h2><a class="nav-anchor" id="Kronecker-graphs-1" href="#Kronecker-graphs-1">Kronecker graphs</a></h2><p>An exciting application of Kronecker powers (or Krocker products in general) is generating large, realistic graphs from an initial &#39;seed&#39; via a stochastic process. This is called a Kronecker graph and is described in detail in <a href="https://cs.stanford.edu/~jure/pubs/kronecker-jmlr10.pdf">Leskovec et al. (2008)</a>.</p><p>If we use an initial matrix <span>$P$</span> with values in <span>$[0,1]$</span> as a seed, then <span>$P_n=P^{\otimes n}$</span> can be seen as a probability distribution for an adjacency matrix of a graph. The elements <span>$(P_n)_{i,j}$</span> give the probabilities that there is an edge from node <span>$i$</span> to node <span>$j$</span>. Leskovec and co-authors give two algorithms for sampling adjacency matrices from this distribution, both provided by <code>Kronecker.jl</code>:</p><ul><li><code>naivesample</code> gives exact samples, but has a computational time proportional to the number of elements and hence prohibitive for large graphs;</li><li><code>fastsample</code> a recursive heuristic, has a computational time proportional to the expected number of edges in the graph.</li></ul><p>The latter can easily scale to generate graphs of millions of nodes. Both return the adjacency matrix as a sparse array.</p><pre><code class="language-julia-repl">julia&gt; using Kronecker

julia&gt; P = rand(2, 2)
2×2 Array{Float64,2}:
 0.610449  0.651346
 0.618195  0.160394

julia&gt; P10 = P ⊗ 10
1024×1024 KroneckerPower{Array{Float64,2},10}:
 0.00718613  0.00766755  0.00766755  0.00818124   …  0.0128811    0.0137441
 0.00727731  0.00188813  0.00776485  0.00201463      0.0130446    0.00338447
 0.00727731  0.00776485  0.00188813  0.00201463      0.00317197   0.00338447
 0.00736965  0.00191209  0.00191209  0.0004961       0.00321222   0.000833424
 0.00727731  0.00776485  0.00776485  0.00828505      0.00317197   0.00338447
 0.00736965  0.00191209  0.00786338  0.00204019   …  0.00321222   0.000833424
 0.00736965  0.00786338  0.00191209  0.00204019      0.000781095  0.000833424
 0.00746316  0.00193635  0.00193635  0.000502395     0.000791006  0.00020523
 0.00727731  0.00776485  0.00776485  0.00828505      0.00317197   0.00338447
 0.00736965  0.00191209  0.00786338  0.00204019      0.00321222   0.000833424
 ⋮                                                ⋱
 0.0080497   0.00208853  0.00208853  0.000541879  …  1.76373e-7   4.57607e-8
 0.00784923  0.00837509  0.00837509  0.00893617      7.07262e-7   7.54644e-7
 0.00794883  0.00206236  0.00848136  0.00220053      7.16236e-7   1.85831e-7
 0.00794883  0.00848136  0.00206236  0.00220053      1.74163e-7   1.85831e-7
 0.0080497   0.00208853  0.00208853  0.000541879     1.76373e-7   4.57607e-8
 0.00794883  0.00848136  0.00848136  0.00904956   …  1.74163e-7   1.85831e-7
 0.0080497   0.00208853  0.00858898  0.00222845      1.76373e-7   4.57607e-8
 0.0080497   0.00858898  0.00208853  0.00222845      4.28875e-8   4.57607e-8
 0.00815184  0.00211503  0.00211503  0.000548754     4.34317e-8   1.12686e-8

julia&gt; sum(P10)  # expected number of edges
1250.5984653865205

julia&gt; A = fastsample(P10)
1024×1024 SparseArrays.SparseMatrixCSC{Bool,Int64} with 1249 stored entries:
  [172 ,    1]  =  true
  [299 ,    1]  =  true
  [356 ,    1]  =  true
  [397 ,    1]  =  true
  [447 ,    1]  =  true
  [565 ,    1]  =  true
  [613 ,    1]  =  true
  [782 ,    1]  =  true
  [836 ,    1]  =  true
  ⋮
  [132 ,  993]  =  true
  [22  , 1001]  =  true
  [17  , 1011]  =  true
  [955 , 1014]  =  true
  [3   , 1018]  =  true
  [55  , 1019]  =  true
  [533 , 1020]  =  true
  [97  , 1021]  =  true
  [9   , 1024]  =  true</code></pre><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Kronecker.isprob" href="#Kronecker.isprob"><code>Kronecker.isprob</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">isprob(A::AbstractArray)</code></pre><p>Test if a matrix can be interpeted as a probability matrix, i.e., all elements are between 0 and 1.</p></div></div><a class="source-link" target="_blank" href="https://github.com/MichielStock/Kronecker.jl/blob/1b436cde2f17d8fbf6caa7143cd9e027654e2826/src/kroneckergraphs.jl#L19-L24">source</a><div><div><pre><code class="language-none">isprob(K::AbstractKroneckerProduct)</code></pre><p>Test if a Kronecker product can be interpeted as a probability matrix, i.e., all elements are between 0 and 1.</p></div></div><a class="source-link" target="_blank" href="https://github.com/MichielStock/Kronecker.jl/blob/1b436cde2f17d8fbf6caa7143cd9e027654e2826/src/kroneckergraphs.jl#L27-L32">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Kronecker.naivesample" href="#Kronecker.naivesample"><code>Kronecker.naivesample</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">naivesample(P::AbstractKroneckerProduct)</code></pre><p>Sample a Kronecker graph from a probabilistic Kronecker product P using the naive method. This method has a time complexity in the size of the Kronecker product (but is still light in memory use). Consider using <code>fastsample</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/MichielStock/Kronecker.jl/blob/1b436cde2f17d8fbf6caa7143cd9e027654e2826/src/kroneckergraphs.jl#L38-L44">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Kronecker.fastsample" href="#Kronecker.fastsample"><code>Kronecker.fastsample</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">fastsample(P::AbstractKroneckerProduct)</code></pre><p>Uses the heuristic sampling from Leskovec et al. (2008) to sample a large Kronecker graph.</p></div></div><a class="source-link" target="_blank" href="https://github.com/MichielStock/Kronecker.jl/blob/1b436cde2f17d8fbf6caa7143cd9e027654e2826/src/kroneckergraphs.jl#L87-L92">source</a></section><footer><hr/><a class="previous" href="../indexed/"><span class="direction">Previous</span><span class="title">Indexed Kronecker products</span></a><a class="next" href="../kroneckersums/"><span class="direction">Next</span><span class="title">Kronecker sums</span></a></footer></article></body></html>
