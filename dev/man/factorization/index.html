<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Factorization methods · Kronecker.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>Kronecker.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../../">Kronecker.jl</a></li><li><a class="toctext" href="../basic/">Basic use</a></li><li class="current"><a class="toctext" href>Factorization methods</a><ul class="internal"><li><a class="toctext" href="#Eigenvalue-decomposition-1">Eigenvalue decomposition</a></li><li><a class="toctext" href="#Cholesky-factorization-1">Cholesky factorization</a></li></ul></li><li><a class="toctext" href="../indexed/">Indexed Kronecker products</a></li><li><a class="toctext" href="../kroneckerpowers/">Kronecker powers and graphs</a></li><li><a class="toctext" href="../kroneckersums/">Kronecker sums</a></li><li><a class="toctext" href="../multiplication/">Multiplication</a></li><li><a class="toctext" href="../types/">Types</a></li></ul></nav><article id="docs"><header><nav><ul><li><a href>Factorization methods</a></li></ul><a class="edit-page" href="https://github.com/MichielStock/Kronecker.jl/blob/master/docs/src/man/factorization.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Factorization methods</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Factorization-methods-1" href="#Factorization-methods-1">Factorization methods</a></h1><p>Many forms of matrix factorization such as eigenvalue decomposition, LU factorization, Cholesky factoization etc., can be computed efficiently. The decomposition of the Kronecker product is the Kronecker product of the decompositions. We have overloaded some of the factorization functions from <code>LinearAlgebra</code> to compute the factorization of instances of <code>AbstractKroneckerProduct</code>.</p><h2><a class="nav-anchor" id="Eigenvalue-decomposition-1" href="#Eigenvalue-decomposition-1">Eigenvalue decomposition</a></h2><p>The function <code>eigen</code> of <code>LinearAlgebra</code> is overloaded to compute the decomposition of <code>AbstractKroneckerProduct</code>s. The result is a factorization of the <code>Eigen</code> type, containing a vector of the eigenvalues and a matrix with the eigenvectors. Just like long-time users would expect! The eigenvectors are structured as Kronecker products and can be processed accordingly.</p><p>The functions <code>det</code>, <code>logdet</code>, <code>inv</code> and <code>\</code> are overloaded the make use of this decomposition.</p><p>The eigenvalue decompositon of matrices can be used to solve large systems of the form:</p><div>\[(A \otimes B + c\cdot I) \mathbf{x} = \mathbf{b}\]</div><p>The case where <span>$A$</span> and <span>$B$</span> are positive semi-definite frequently occurs in machine learning, for example in ridge regression.</p><pre><code class="language-julia-repl">
julia&gt; A, B = rand(10, 10), randn(4, 4);

julia&gt; As, Bs = (A, B) .|&gt; X -&gt; X * X&#39;;  # make positive definite

julia&gt; K = As ⊗ Bs
40×40 Kronecker.KroneckerProduct{Float64,Array{Float64,2},Array{Float64,2}}:
  5.82496   -1.24601     1.10805   …  -0.756115    0.672401    4.01919
 -1.24601    3.63871     2.14915       2.20808     1.30417    -2.73997
  1.10805    2.14915    13.1456        1.30417     7.97715   -12.4514
  6.62325   -4.51521   -20.5187       -2.73997   -12.4514     27.1198
  3.938     -0.842371    0.749107     -0.763042    0.678561    4.05601
 -0.842371   2.45997     1.45295   …   2.22831     1.31612    -2.76507
  0.749107   1.45295     8.88716       1.31612     8.05022   -12.5655
  4.47769   -3.05253   -13.8718       -2.76507   -12.5655     27.3682
  4.51748   -0.966326    0.859338     -0.994601    0.884483    5.28688
 -0.966326   2.82196     1.66675       2.90453     1.71552    -3.60418
  ⋮                                ⋱
  4.98462   -3.39812   -15.4423       -3.07151   -13.958      30.4013
  4.52131   -0.967145    0.860067     -0.977232    0.869037    5.19456
 -0.967145   2.82435     1.66816       2.85381     1.68556    -3.54124
  0.860067   1.66816    10.2036        1.68556    10.31      -16.0927
  5.14094   -3.50468   -15.9265    …  -3.54124   -16.0927     35.0506
  3.53477   -0.756115    0.672401     -0.947769    0.842836    5.03794
 -0.756115   2.20808     1.30417       2.76777     1.63474    -3.43447
  0.672401   1.30417     7.97715       1.63474     9.99913   -15.6075
  4.01919   -2.73997   -12.4514       -3.43447   -15.6075     33.9939

julia&gt; E = eigen(K)
Eigen{Float64,Float64,Kronecker.KroneckerProduct{Float64,Array{Float64,2},Array{Float64,2}},Array{Float64,1}}
eigenvalues:
40-element Array{Float64,1}:
   8.21457460529029e-6
   0.0008273691539091695
   0.002179476401990521
   0.014785586044919585
   0.0002207496038276809
   0.02223382484432844
   0.058568894362629624
   0.3973318666646579
   0.0014397135439867539
   0.1450074573542446
   ⋮
  20.22256721246186
   0.016498780518772852
   1.6617515494422606
   4.3774272594868755
  29.69650294970307
   0.21978290579928136
  22.13645934845389
  58.312411751906154
 395.5918864995072
eigenvectors:
40×40 Kronecker.KroneckerProduct{Float64,Array{Float64,2},Array{Float64,2}}:
 -0.111904    0.00383983   0.146069   …  0.00641532   0.244042   -0.0342661
 -0.0234645   0.181686    -0.020223      0.303549    -0.0337872   0.0300971
  0.126453    0.0204102    0.10751       0.0341       0.17962     0.132911
  0.0723219   0.0292018    0.0314727     0.0487885    0.0525824  -0.275647
 -0.0973083   0.003339     0.127017      0.00649954   0.247245   -0.0347159
 -0.0204041   0.157989    -0.0175853  …  0.307534    -0.0342307   0.0304922
  0.10996     0.0177481    0.0934874     0.0345476    0.181978    0.134655
  0.062889    0.0253931    0.0273677     0.0494289    0.0532727  -0.279265
  0.228838   -0.00785225  -0.298703      0.00826746   0.314498   -0.0441589
  0.0479837  -0.371539     0.0413549     0.391185    -0.0435417   0.0387864
  ⋮                                   ⋱
  0.190233    0.0768117    0.0827848     0.0582234    0.0627511  -0.328953
 -0.0719181   0.00246777   0.0938752     0.00815761   0.310319   -0.0435721
 -0.0150801   0.116766    -0.0129969     0.385988    -0.0429632   0.038271
  0.0812688   0.0131172    0.0690942     0.0433609    0.228402    0.169007
  0.0464797   0.0187674    0.0202268  …  0.0620386    0.0668628  -0.350507
  0.0904528  -0.00310376  -0.118069      0.00579672   0.22051    -0.0309619
  0.0189666  -0.146858     0.0163464     0.274279    -0.0305292   0.027195
 -0.102213   -0.0164977   -0.086901      0.0308118    0.1623      0.120095
 -0.0584584  -0.0236041   -0.0254396     0.044084     0.0475121  -0.249067

julia&gt; logdet(E)
-54.98633543213958

julia&gt; b = randn(40);

julia&gt; (E + 0.1I) \ b  # solve a system
40-element Array{Float64,1}:
   4.124459752389865
  -0.26476179787526843
  -5.611478719753868
  -4.803802565618542
  -1.825795991538653
  -1.1294835222001982
   2.4601676731128443
   0.18195882410434966
  -3.6613049944986598
   2.084245345624615
   ⋮
  -4.688604190157852
  -8.146125540513609
  -3.9993856689025065
   8.89018543061493
   4.195831996711126
   5.191730920002242
   3.3860830295327586
 -10.249009731450196
  -4.020734091187463</code></pre><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="LinearAlgebra.eigen" href="#LinearAlgebra.eigen"><code>LinearAlgebra.eigen</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">eigen(K::AbstractKroneckerProduct)</code></pre><p>Wrapper around <code>eigen</code> from the <code>LinearAlgebra</code> package. Performs Eigenvalue decompositon on the matrices of a <code>AbstractKroneckerProduct</code> instances and returns an <code>Eigen</code> type. The functions <code>size</code>, <code>\</code>, <code>inv</code>, <code>det</code>, and <code>logdet</code> are overloaded to efficiently work with this type.</p></div></div><a class="source-link" target="_blank" href="https://github.com/MichielStock/Kronecker.jl/blob/0e62b2a39531d3687a70a9fa17919099479a9e34/src/eigen.jl#L5-L12">source</a></section><div class="admonition warning"><div class="admonition-title">Missing docstring.</div><div class="admonition-text"><p>Missing docstring for <code>+(E::Eigen, B::UniformScaling)</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition warning"><div class="admonition-title">Missing docstring.</div><div class="admonition-text"><p>Missing docstring for <code>+(::Eigen, ::UniformScaling)</code>. Check Documenter&#39;s build log for details.</p></div></div><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="LinearAlgebra.det-Tuple{Eigen{#s4,#s3,#s2,U} where U&lt;:(AbstractArray{T,1} where T) where #s2&lt;:AbstractKroneckerProduct where #s3&lt;:Number where #s4&lt;:Number}" href="#LinearAlgebra.det-Tuple{Eigen{#s4,#s3,#s2,U} where U&lt;:(AbstractArray{T,1} where T) where #s2&lt;:AbstractKroneckerProduct where #s3&lt;:Number where #s4&lt;:Number}"><code>LinearAlgebra.det</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">det(K::Eigen)</code></pre><p>Compute the determinant of the eigenvalue decomp of aKronecker product.</p></div></div><a class="source-link" target="_blank" href="https://github.com/MichielStock/Kronecker.jl/blob/0e62b2a39531d3687a70a9fa17919099479a9e34/src/eigen.jl#L40-L44">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="LinearAlgebra.logdet-Tuple{Eigen{#s4,#s3,#s2,U} where U&lt;:(AbstractArray{T,1} where T) where #s2&lt;:AbstractKroneckerProduct where #s3&lt;:Number where #s4&lt;:Number}" href="#LinearAlgebra.logdet-Tuple{Eigen{#s4,#s3,#s2,U} where U&lt;:(AbstractArray{T,1} where T) where #s2&lt;:AbstractKroneckerProduct where #s3&lt;:Number where #s4&lt;:Number}"><code>LinearAlgebra.logdet</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">logdet(K::Eigen)</code></pre><p>Compute the logarithm of the determinant of the eigenvalue decomp of aKronecker product.</p></div></div><a class="source-link" target="_blank" href="https://github.com/MichielStock/Kronecker.jl/blob/0e62b2a39531d3687a70a9fa17919099479a9e34/src/eigen.jl#L47-L52">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Base.inv-Tuple{Eigen{#s4,#s3,#s2,U} where U&lt;:(AbstractArray{T,1} where T) where #s2&lt;:AbstractKroneckerProduct where #s3&lt;:Number where #s4&lt;:Number}" href="#Base.inv-Tuple{Eigen{#s4,#s3,#s2,U} where U&lt;:(AbstractArray{T,1} where T) where #s2&lt;:AbstractKroneckerProduct where #s3&lt;:Number where #s4&lt;:Number}"><code>Base.inv</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">inv(K::Eigen)</code></pre><p>Compute the inverse of the eigenvalue decomp of aKronecker product. Returns another type of <code>Eigen</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/MichielStock/Kronecker.jl/blob/0e62b2a39531d3687a70a9fa17919099479a9e34/src/eigen.jl#L55-L60">source</a></section><h2><a class="nav-anchor" id="Cholesky-factorization-1" href="#Cholesky-factorization-1">Cholesky factorization</a></h2><p>Similar to the eigenvalue decomposition, <code>cholesky</code> has been overloaded to allow for efficient Cholesky decomposition of Kronecker products of symmetric and positive definite matrices.</p><pre><code class="language-julia-repl">
julia&gt; A, B = rand(10, 10), randn(4, 4);

julia&gt; As, Bs = (A, B) .|&gt; X -&gt; X * X&#39;;  # make positive definite

julia&gt; K = As ⊗ Bs
40×40 Kronecker.KroneckerProduct{Float64,Array{Float64,2},Array{Float64,2}}:
 11.2512     5.59437   0.29037   -3.37619   …   5.91329   0.306924  -3.56866
  5.59437   14.1016   -3.88646    3.43827      14.9056   -4.10802    3.63428
  0.29037   -3.88646   3.44402    0.949778     -4.10802   3.64036    1.00392
 -3.37619    3.43827   0.949778   7.49218       3.63428   1.00392    7.9193
  9.69221    4.8192    0.250136  -2.90838       6.92307   0.359335  -4.17806
  4.8192    12.1477   -3.34794    2.96185   …  17.4509   -4.80952    4.25488
  0.250136  -3.34794   2.96681    0.818175     -4.80952   4.26201    1.17536
 -2.90838    2.96185   0.818175   6.45404       4.25488   1.17536    9.27163
 12.7224     6.32586   0.328338  -3.81765       9.43765   0.489852  -5.69561
  6.32586   15.9455   -4.39463    3.88784      23.7893   -6.55642    5.80033
  ⋮                                         ⋱
 -2.7003     2.74995   0.759639   5.99229       3.60783   0.996617   7.86166
 10.9594     5.44928   0.28284   -3.28863       7.57939   0.393401  -4.57415
  5.44928   13.7359   -3.78567    3.3491       19.1053   -5.26547    4.65825
  0.28284   -3.78567   3.35471    0.925147     -5.26547   4.66605    1.28678
 -3.28863    3.3491    0.925147   7.29788   …   4.65825   1.28678   10.1506
 11.8926     5.91329   0.306924  -3.56866      10.9267    0.567141  -6.59426
  5.91329   14.9056   -4.10802    3.63428      27.5428   -7.5909     6.71551
  0.306924  -4.10802   3.64036    1.00392      -7.5909    6.72675    1.85507
 -3.56866    3.63428   1.00392    7.9193        6.71551   1.85507   14.6335

julia&gt; C = cholesky(K)
40×40 CholeskyKronecker{Cholesky{Float64,Array{Float64,2}},Cholesky{Float64,Array{Float64,2}}}
U factor:
40×40 Kronecker.KroneckerProduct{Float64,UpperTriangular{Float64,Array{Float64,2}},UpperTriangular{Float64,Array{Float64,2}}}:
 3.35428  1.66783   0.086567  -1.00653   …   1.76291    0.0915021  -1.06391
 0.0      3.36452  -1.19804    1.52087       3.55633   -1.26634     1.60757
 0.0      0.0       1.41465    2.02098       0.0        1.49529     2.1362
 0.0      0.0       0.0        0.285747      0.0        0.0         0.302037
 0.0      0.0       0.0       -0.0           0.771401   0.0400388  -0.465539
 0.0      0.0      -0.0        0.0       …   1.55615   -0.554117    0.703429
 0.0      0.0       0.0        0.0           0.0        0.654299    0.934742
 0.0      0.0       0.0        0.0           0.0        0.0         0.132163
 0.0      0.0       0.0       -0.0           0.674996   0.035035   -0.407359
 0.0      0.0      -0.0        0.0           1.36167   -0.484867    0.615519
 ⋮                                       ⋱
 0.0      0.0       0.0        0.0          -0.0       -0.0        -0.0569594
 0.0      0.0       0.0       -0.0           0.070193   0.0036433  -0.0423614
 0.0      0.0      -0.0        0.0           0.141601  -0.0504214   0.064008
 0.0      0.0       0.0        0.0           0.0        0.0595374   0.0850561
 0.0      0.0       0.0        0.0       …   0.0        0.0         0.0120261
 0.0      0.0       0.0       -0.0           0.422874   0.0219489  -0.255204
 0.0      0.0      -0.0        0.0           0.853066  -0.303761    0.385613
 0.0      0.0       0.0        0.0           0.0        0.35868     0.512416
 0.0      0.0       0.0        0.0           0.0        0.0         0.0724505

julia&gt; logdet(C)
-21.476926562690903

julia&gt; inv(C)
40×40 Kronecker.KroneckerProduct{Float64,Array{Float64,2},Array{Float64,2}}:
  130.705    -152.96     -227.173    …   -76.2279  -113.212     78.6864
 -152.96      181.298     268.837         90.3501   133.975    -92.7974
 -227.173     268.837     403.481        133.975    201.075   -137.99
  157.894    -186.209    -276.893        -92.7974  -137.99      96.59
    5.60075    -6.55441    -9.73447       10.0814    14.9726   -10.4065
   -6.55441     7.7687     11.5198   …   -11.9491   -17.7186    12.2727
   -9.73447    11.5198     17.2894       -17.7186   -26.5928    18.2496
    6.76581    -7.97913   -11.865         12.2727    18.2496   -12.7743
 -120.93      141.521     210.184        182.862    271.583   -188.76
  141.521    -167.74     -248.732       -216.74    -321.391    222.61
    ⋮                                ⋱
   92.8843   -109.541    -162.888       -107.825   -160.336    112.232
   33.1119    -38.75      -57.5507        20.8521    30.9691   -21.5246
  -38.75       45.929      68.1054       -24.7152   -36.6488    25.3847
  -57.5507     68.1054    102.216        -36.6488   -55.004     37.747
   39.9998    -47.173     -70.1464   …    25.3847    37.747    -26.4221
   65.1368    -76.2279   -113.212       -150.348   -223.294    155.197
  -76.2279     90.3501    133.975        178.202    264.246   -183.029
 -113.212     133.975     201.075        264.246    396.592   -272.165
   78.6864    -92.7974   -137.99        -183.029   -272.165    190.51</code></pre><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="LinearAlgebra.cholesky" href="#LinearAlgebra.cholesky"><code>LinearAlgebra.cholesky</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">cholesky(K::AbstractKroneckerProduct; check = true)</code></pre><p>Wrapper around <code>cholesky</code> from the <code>LinearAlgebra</code> package. Performs Cholesky on the matrices of a <code>AbstractKroneckerProduct</code> instances and returns a <code>CholeskyKronecker</code> type. Similar to <code>Cholesky</code>, <code>size</code>, <code>\</code>, <code>inv</code>, <code>det</code>, and <code>logdet</code> are overloaded to efficiently work with this type.</p></div></div><a class="source-link" target="_blank" href="https://github.com/MichielStock/Kronecker.jl/blob/0e62b2a39531d3687a70a9fa17919099479a9e34/src/factorization.jl#L42-L49">source</a></section><footer><hr/><a class="previous" href="../basic/"><span class="direction">Previous</span><span class="title">Basic use</span></a><a class="next" href="../indexed/"><span class="direction">Next</span><span class="title">Indexed Kronecker products</span></a></footer></article></body></html>
