<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Factorization methods · Kronecker.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../basic/">Kronecker.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../basic/">Basic use</a></li><li><a class="tocitem" href="../types/">Types</a></li><li><a class="tocitem" href="../multiplication/">Multiplication</a></li><li class="is-active"><a class="tocitem" href>Factorization methods</a><ul class="internal"><li><a class="tocitem" href="#Eigenvalue-decomposition"><span>Eigenvalue decomposition</span></a></li><li><a class="tocitem" href="#Cholesky-factorization"><span>Cholesky factorization</span></a></li></ul></li><li><a class="tocitem" href="../indexed/">Indexed Kronecker products</a></li><li><a class="tocitem" href="../kroneckersums/">Kronecker sums</a></li><li><a class="tocitem" href="../kroneckerpowers/">Kronecker powers and graphs</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Factorization methods</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Factorization methods</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/MichielStock/Kronecker.jl/blob/master/docs/src/man/factorization.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Factorization-methods"><a class="docs-heading-anchor" href="#Factorization-methods">Factorization methods</a><a id="Factorization-methods-1"></a><a class="docs-heading-anchor-permalink" href="#Factorization-methods" title="Permalink"></a></h1><p>Many forms of matrix factorization such as eigenvalue decomposition, LU factorization, Cholesky factorization etc., can be computed efficiently. The decomposition of the Kronecker product is the Kronecker product of the decompositions. We have overloaded some of the factorization functions from <code>LinearAlgebra</code> to compute the factorization of instances of <code>AbstractKroneckerProduct</code>.</p><h2 id="Eigenvalue-decomposition"><a class="docs-heading-anchor" href="#Eigenvalue-decomposition">Eigenvalue decomposition</a><a id="Eigenvalue-decomposition-1"></a><a class="docs-heading-anchor-permalink" href="#Eigenvalue-decomposition" title="Permalink"></a></h2><p>The function <code>eigen</code> of <code>LinearAlgebra</code> is overloaded to compute the decomposition of <code>AbstractKroneckerProduct</code>s. The result is a factorization of the <code>Eigen</code> type, containing a vector of the eigenvalues and a matrix with the eigenvectors. Just like long-time users would expect! The eigenvectors are structured as Kronecker products and can be processed accordingly.</p><p>The functions <code>det</code>, <code>logdet</code>, <code>inv</code> and <code>\</code> are overloaded the make use of this decomposition.</p><p>The eigenvalue decomposition of matrices can be used to solve large systems of the form:</p><p class="math-container">\[(A \otimes B + c\cdot I) \mathbf{x} = \mathbf{b}\]</p><p>The case where <span>$A$</span> and <span>$B$</span> are positive semi-definite frequently occurs in machine learning, for example in ridge regression.</p><pre><code class="language-julia-repl">
julia&gt; A, B = rand(10, 10), randn(4, 4);

julia&gt; As, Bs = (A, B) .|&gt; X -&gt; X * X&#39;;  # make positive definite

julia&gt; K = As ⊗ Bs
40×40 Kronecker.KroneckerProduct{Float64,Array{Float64,2},Array{Float64,2}}:
  8.49715   4.25467  -2.80142    8.05189   …  2.63639  -1.73589    4.98933
  4.25467   9.90051   3.38309   10.9359       6.13482   2.09632    6.77637
 -2.80142   3.38309   5.23027   -0.597724     2.09632   3.24092   -0.370378
  8.05189  10.9359   -0.597724  24.5804       6.77637  -0.370378  15.2312
  5.96666   2.98761  -1.96714    5.65401      2.03463  -1.33967    3.8505
  2.98761   6.9521    2.37559    7.67912   …  4.73454   1.61783    5.22965
 -1.96714   2.37559   3.67267   -0.419719     1.61783   2.50117   -0.285838
  5.65401   7.67912  -0.419719  17.2603       5.22965  -0.285838  11.7546
  5.53131   2.76962  -1.82361    5.24146      1.84345  -1.21379    3.4887
  2.76962   6.44484   2.20226    7.11881      4.28966   1.46581    4.73825
  ⋮                                        ⋱
  5.85566   7.953    -0.434689  17.8759       6.75675  -0.369305  15.1871
  6.23339   3.12116  -2.05508    5.90676      2.88572  -1.90006    5.46119
  3.12116   7.26288   2.48179    8.0224       6.71501   2.29457    7.41724
 -2.05508   2.48179   3.83685   -0.438482     2.29457   3.54742   -0.405406
  5.90676   8.0224   -0.438482  18.0319    …  7.41724  -0.405406  16.6717
  5.26523   2.63639  -1.73589    4.98933      2.36569  -1.55765    4.47703
  2.63639   6.13482   2.09632    6.77637      5.50491   1.88107    6.08059
 -1.73589   2.09632   3.24092   -0.370378     1.88107   2.90815   -0.332348
  4.98933   6.77637  -0.370378  15.2312       6.08059  -0.332348  13.6673

julia&gt; E = eigen(K)
Eigen{Float64,Float64,Kronecker.KroneckerProduct{Float64,Array{Float64,2},Array{Float64,2}},Array{Float64,1}}
values:
40-element Array{Float64,1}:
   0.0008046676156485759
   0.00850543013581887
   0.017140677439816992
   0.06145031629748631
   0.005818523395256543
   0.06150246793776225
   0.12394363927984643
   0.4443450886670107
   0.01518726276319659
   0.16053113095967633
   ⋮
  18.9393925170509
   0.3795168723662637
   4.0115374106039505
   8.084302345080754
  28.98268973872171
   3.011451162350852
  31.831388477291497
  64.14861490108889
 229.9764807755255
vectors:
40×40 Kronecker.KroneckerProduct{Float64,Array{Float64,2},Array{Float64,2}}:
  0.129053     -0.227643     -0.160326     …  -0.166427   -0.115038
 -0.196279     -0.150887      0.156009         0.161946   -0.14982
  0.220559     -0.0414947     0.236841         0.245854   -0.000580946
  0.0513355     0.173643     -0.0180239       -0.0187098  -0.281138
 -0.0644603     0.113704      0.0800808       -0.154908   -0.107076
  0.0980387     0.0753659    -0.0779244    …   0.150737   -0.13945
 -0.110166      0.020726     -0.118299         0.228837   -0.000540737
 -0.0256413    -0.0867323     0.00900269      -0.0174148  -0.261679
  0.0516046    -0.0910275    -0.0641097       -0.167038   -0.11546
 -0.0784862    -0.0603352     0.0623834        0.16254    -0.150369
  ⋮                                        ⋱
 -0.0713313    -0.24128       0.0250445       -0.0170985  -0.256926
 -0.00140551    0.00247923    0.0017461       -0.166334   -0.114974
  0.00213766    0.0016433    -0.00169908       0.161855   -0.149736
 -0.00240208    0.000451914  -0.00257941       0.245716   -0.000580621
 -0.000559089  -0.00189113    0.000196297  …  -0.0186993  -0.28098
  0.110807     -0.195458     -0.137659        -0.123276   -0.0852109
 -0.168529     -0.129554      0.133952         0.119956   -0.110974
  0.189376     -0.035628      0.203355         0.182108   -0.000430317
  0.0440775     0.149093     -0.0154756       -0.0138587  -0.208243

julia&gt; logdet(E)
-10.340100477607878

julia&gt; b = randn(40);

julia&gt; (E + 0.1I) \ b  # solve a system
40-element Array{Float64,1}:
  2.598370862034385
  3.827155105601317
  5.574231435163367
 -3.2654022465326378
 -2.3076138783611193
 -0.7601630424736122
 -7.532633438166987
  2.1675965718968224
 -0.47338511234116526
  3.0120405403163777
  ⋮
  2.8165032481492527
  7.569502018503032
 -9.07851749211959
  7.197436859675919
  2.6605483425940077
 -7.483091109875247
 11.608008878129038
 -1.9834126455663543
 -4.866750105314728</code></pre><article class="docstring"><header><a class="docstring-binding" id="LinearAlgebra.eigen" href="#LinearAlgebra.eigen"><code>LinearAlgebra.eigen</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">eigen(K::AbstractKroneckerProduct)</code></pre><p>Wrapper around <code>eigen</code> from the <code>LinearAlgebra</code> package. If the matrices of an <code>AbstractKroneckerProduct</code> instance are square, performs Eigenvalue decompositon on them and returns an <code>Eigen</code> type. Otherwise, it collects the instance and runs eigen on the full matrix. The functions, <code>\</code>, <code>inv</code>, and <code>logdet</code> are overloaded to efficiently work with this type.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MichielStock/Kronecker.jl/blob/d012eedf17099e5a65c2209b6d51704ea9829eb1/src/eigen.jl#L5-L14">source</a></section></article><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>+(E::Eigen, B::UniformScaling)</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>+(::Eigen, ::UniformScaling)</code>. Check Documenter&#39;s build log for details.</p></div></div><article class="docstring"><header><a class="docstring-binding" id="LinearAlgebra.det-Tuple{Eigen{var&quot;#s5&quot;,var&quot;#s3&quot;,var&quot;#s2&quot;,U} where U&lt;:(AbstractArray{T,1} where T) where var&quot;#s2&quot;&lt;:AbstractKroneckerProduct where var&quot;#s3&quot;&lt;:Number where var&quot;#s5&quot;&lt;:Number}" href="#LinearAlgebra.det-Tuple{Eigen{var&quot;#s5&quot;,var&quot;#s3&quot;,var&quot;#s2&quot;,U} where U&lt;:(AbstractArray{T,1} where T) where var&quot;#s2&quot;&lt;:AbstractKroneckerProduct where var&quot;#s3&quot;&lt;:Number where var&quot;#s5&quot;&lt;:Number}"><code>LinearAlgebra.det</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">det(K::AbstractKroneckerProduct)</code></pre><p>Compute the determinant of a Kronecker product.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MichielStock/Kronecker.jl/blob/d012eedf17099e5a65c2209b6d51704ea9829eb1/src/base.jl#L206-L210">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LinearAlgebra.logdet-Tuple{Eigen{var&quot;#s5&quot;,var&quot;#s3&quot;,var&quot;#s2&quot;,U} where U&lt;:(AbstractArray{T,1} where T) where var&quot;#s2&quot;&lt;:AbstractKroneckerProduct where var&quot;#s3&quot;&lt;:Number where var&quot;#s5&quot;&lt;:Number}" href="#LinearAlgebra.logdet-Tuple{Eigen{var&quot;#s5&quot;,var&quot;#s3&quot;,var&quot;#s2&quot;,U} where U&lt;:(AbstractArray{T,1} where T) where var&quot;#s2&quot;&lt;:AbstractKroneckerProduct where var&quot;#s3&quot;&lt;:Number where var&quot;#s5&quot;&lt;:Number}"><code>LinearAlgebra.logdet</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">logdet(K::Eigen)</code></pre><p>Compute the logarithm of the determinant of the eigenvalue decomp of aKronecker product.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MichielStock/Kronecker.jl/blob/d012eedf17099e5a65c2209b6d51704ea9829eb1/src/eigen.jl#L46-L51">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.inv-Tuple{Eigen{var&quot;#s5&quot;,var&quot;#s3&quot;,var&quot;#s2&quot;,U} where U&lt;:(AbstractArray{T,1} where T) where var&quot;#s2&quot;&lt;:AbstractKroneckerProduct where var&quot;#s3&quot;&lt;:Number where var&quot;#s5&quot;&lt;:Number}" href="#Base.inv-Tuple{Eigen{var&quot;#s5&quot;,var&quot;#s3&quot;,var&quot;#s2&quot;,U} where U&lt;:(AbstractArray{T,1} where T) where var&quot;#s2&quot;&lt;:AbstractKroneckerProduct where var&quot;#s3&quot;&lt;:Number where var&quot;#s5&quot;&lt;:Number}"><code>Base.inv</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">inv(K::Eigen)</code></pre><p>Compute the inverse of the eigenvalue decomp of aKronecker product. Returns another type of <code>Eigen</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MichielStock/Kronecker.jl/blob/d012eedf17099e5a65c2209b6d51704ea9829eb1/src/eigen.jl#L54-L59">source</a></section></article><h2 id="Cholesky-factorization"><a class="docs-heading-anchor" href="#Cholesky-factorization">Cholesky factorization</a><a id="Cholesky-factorization-1"></a><a class="docs-heading-anchor-permalink" href="#Cholesky-factorization" title="Permalink"></a></h2><p>Similar to the eigenvalue decomposition, <code>cholesky</code> has been overloaded to allow for efficient Cholesky decomposition of Kronecker products of symmetric and positive definite matrices.</p><pre><code class="language-julia-repl">
julia&gt; A, B = rand(10, 10), randn(4, 4);

julia&gt; As, Bs = (A, B) .|&gt; X -&gt; X * X&#39;;  # make positive definite

julia&gt; K = As ⊗ Bs
40×40 Kronecker.KroneckerProduct{Float64,Array{Float64,2},Array{Float64,2}}:
  1.84797    -0.047236    -1.61576   …  -0.0443965   -1.51863     1.12487
 -0.047236    1.18841     -1.53926       1.11697     -1.44673     1.76037
 -1.61576    -1.53926     12.4979       -1.44673     11.7466    -10.0602
  1.19681     1.87296    -10.7037        1.76037    -10.0602      9.11053
  1.00648    -0.0257266   -0.880007     -0.0267286   -0.914282    0.677218
 -0.0257266   0.647254    -0.838339  …   0.672464    -0.870992    1.05982
 -0.880007   -0.838339     6.80683      -0.870992     7.07195    -6.0567
  0.65183     1.02009     -5.82964       1.05982     -6.0567      5.48493
  1.40485    -0.0359094   -1.22832      -0.0545607   -1.86631     1.3824
 -0.0359094   0.903443    -1.17016       1.37269     -1.77794     2.16339
  ⋮                                  ⋱
  0.952089    1.48998     -8.51501       1.71409     -9.7958      8.87105
  2.09167    -0.0534652   -1.82884      -0.0691896   -2.36671     1.75305
 -0.0534652   1.34513     -1.74224       1.74074     -2.25465     2.74344
 -1.82884    -1.74224     14.146        -2.25465     18.3064    -15.6784
  1.35464     2.11995    -12.1152    …   2.74344    -15.6784     14.1983
  1.73688    -0.0443965   -1.51863      -0.0652507   -2.23198     1.65325
 -0.0443965   1.11697     -1.44673       1.64164     -2.12629     2.58726
 -1.51863    -1.44673     11.7466       -2.12629     17.2643    -14.7858
  1.12487     1.76037    -10.0602        2.58726    -14.7858     13.39

julia&gt; C = cholesky(K)
40×40 CholeskyKronecker{Cholesky{Float64,Array{Float64,2}},Cholesky{Float64,Array{Float64,2}}}
U factor:
40×40 Kronecker.KroneckerProduct{Float64,UpperTriangular{Float64,Array{Float64,2}},UpperTriangular{Float64,Array{Float64,2}}}:
 1.3594  -0.0347477  -1.18858  …  -0.0326588   -1.11713     0.827471
 0.0      1.08959    -1.4506       1.02409     -1.3634      1.64201
 0.0      0.0         2.99682      0.0          2.81666    -2.23398
 0.0      0.0         0.0          0.0          0.0         0.437356
 0.0     -0.0        -0.0         -0.00339872  -0.116257    0.0861129
 0.0      0.0        -0.0      …   0.106574    -0.141886    0.17088
 0.0      0.0         0.0          0.0          0.293123   -0.232485
 0.0      0.0         0.0          0.0          0.0         0.0455146
 0.0     -0.0        -0.0         -0.0222182   -0.76        0.56294
 0.0      0.0        -0.0          0.696701    -0.927538    1.11708
 ⋮                             ⋱
 0.0      0.0         0.0         -0.0         -0.0        -0.0240474
 0.0     -0.0        -0.0         -0.00196788  -0.0673137   0.0498599
 0.0      0.0        -0.0          0.0617073   -0.0821527   0.0989409
 0.0      0.0         0.0          0.0          0.16972    -0.13461
 0.0      0.0         0.0      …   0.0          0.0         0.0263532
 0.0     -0.0        -0.0         -0.00651461  -0.22284     0.16506
 0.0      0.0        -0.0          0.20428     -0.271963    0.32754
 0.0      0.0         0.0          0.0          0.561853   -0.445622
 0.0      0.0         0.0          0.0          0.0         0.0872415

julia&gt; logdet(C)
-62.3637206639576

julia&gt; inv(C)
40×40 Kronecker.KroneckerProduct{Float64,Array{Float64,2},Array{Float64,2}}:
  38.6067       4.57833     13.1724   …   -1.71927    -4.94654    -3.33996
   4.57833    146.62      -112.335       -55.0594     42.1844     57.4329
  13.1724    -112.335      182.465        42.1844    -68.52      -83.203
   8.89412   -152.941      221.565        57.4329    -83.203    -104.905
  -7.38757     -0.876084    -2.52059       0.669427    1.92602     1.30047
  -0.876084   -28.0564      21.4957   …   21.4383    -16.4252    -22.3624
  -2.52059     21.4957     -34.9155      -16.4252     26.6794     32.3965
  -1.70193     29.2659     -42.3975      -22.3624     32.3965     40.8464
 -22.7086      -2.69298     -7.74801      -1.27084    -3.65635    -2.46881
  -2.69298    -86.2423      66.0755      -40.6984     31.1815     42.4528
   ⋮                                  ⋱
  -4.46041     76.6997    -111.115       -22.3077     32.3172     40.7465
  21.9177       2.5992       7.47817      -0.80839    -2.32583    -1.57043
   2.5992      83.2388     -63.7743      -25.8885     19.8348     27.0045
   7.47817    -63.7743     103.588        19.8348    -32.2176    -39.1215
   5.04935    -86.8269     125.786    …   27.0045    -39.1215    -49.3255
 -14.4978      -1.71927     -4.94654       2.1533      6.19527     4.18312
  -1.71927    -55.0594      42.1844       68.9589    -52.8336    -71.9315
  -4.94654     42.1844     -68.52        -52.8336     85.8175    104.207
  -3.33996     57.4329     -83.203       -71.9315    104.207     131.388</code></pre><article class="docstring"><header><a class="docstring-binding" id="LinearAlgebra.cholesky" href="#LinearAlgebra.cholesky"><code>LinearAlgebra.cholesky</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">cholesky(K::AbstractKroneckerProduct; check = true)</code></pre><p>Wrapper around <code>cholesky</code> from the <code>LinearAlgebra</code> package. Performs Cholesky on the matrices of a <code>AbstractKroneckerProduct</code> instances and returns a <code>CholeskyKronecker</code> type. Similar to <code>Cholesky</code>, <code>size</code>, <code>\</code>, <code>inv</code>, <code>det</code>, and <code>logdet</code> are overloaded to efficiently work with this type.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MichielStock/Kronecker.jl/blob/d012eedf17099e5a65c2209b6d51704ea9829eb1/src/factorization.jl#L42-L49">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../multiplication/">« Multiplication</a><a class="docs-footer-nextpage" href="../indexed/">Indexed Kronecker products »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.3 on <span class="colophon-date" title="Monday 5 July 2021 15:59">Monday 5 July 2021</span>. Using Julia version 1.5.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
