<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Factorization methods · Kronecker.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">Kronecker.jl</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../basic/">Basic use</a></li><li><a class="tocitem" href="../types/">Types</a></li><li><a class="tocitem" href="../multiplication/">Multiplication</a></li><li class="is-active"><a class="tocitem" href>Factorization methods</a><ul class="internal"><li><a class="tocitem" href="#Eigenvalue-decomposition"><span>Eigenvalue decomposition</span></a></li><li><a class="tocitem" href="#Cholesky-factorization"><span>Cholesky factorization</span></a></li></ul></li><li><a class="tocitem" href="../indexed/">Indexed Kronecker products</a></li><li><a class="tocitem" href="../kroneckersums/">Kronecker sums</a></li><li><a class="tocitem" href="../kroneckerpowers/">Kronecker powers and graphs</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Factorization methods</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Factorization methods</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/MichielStock/Kronecker.jl/blob/master/docs/src/man/factorization.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Factorization-methods"><a class="docs-heading-anchor" href="#Factorization-methods">Factorization methods</a><a id="Factorization-methods-1"></a><a class="docs-heading-anchor-permalink" href="#Factorization-methods" title="Permalink"></a></h1><p>Many forms of matrix factorization such as eigenvalue decomposition, LU factorization, Cholesky factorization etc., can be computed efficiently. The decomposition of the Kronecker product is the Kronecker product of the decompositions. We have overloaded some of the factorization functions from <code>LinearAlgebra</code> to compute the factorization of instances of <code>AbstractKroneckerProduct</code>.</p><h2 id="Eigenvalue-decomposition"><a class="docs-heading-anchor" href="#Eigenvalue-decomposition">Eigenvalue decomposition</a><a id="Eigenvalue-decomposition-1"></a><a class="docs-heading-anchor-permalink" href="#Eigenvalue-decomposition" title="Permalink"></a></h2><p>The function <code>eigen</code> of <code>LinearAlgebra</code> is overloaded to compute the decomposition of <code>AbstractKroneckerProduct</code>s. The result is a factorization of the <code>Eigen</code> type, containing a vector of the eigenvalues and a matrix with the eigenvectors. Just like long-time users would expect! The eigenvectors are structured as Kronecker products and can be processed accordingly.</p><p>The functions <code>det</code>, <code>logdet</code>, <code>inv</code> and <code>\</code> are overloaded the make use of this decomposition.</p><p>The eigenvalue decomposition of matrices can be used to solve large systems of the form:</p><p class="math-container">\[(A \otimes B + c\cdot I) \mathbf{x} = \mathbf{b}\]</p><p>The case where <span>$A$</span> and <span>$B$</span> are positive semi-definite frequently occurs in machine learning, for example in ridge regression.</p><pre><code class="language-julia-repl">
julia&gt; A, B = rand(10, 10), randn(4, 4);

julia&gt; As, Bs = (A, B) .|&gt; X -&gt; X * X&#39;;  # make positive definite

julia&gt; K = As ⊗ Bs
40×40 Kronecker.KroneckerProduct{Float64,Array{Float64,2},Array{Float64,2}}:
  11.5279    -11.3548    -0.681179  …  -10.2201    -0.613105  -6.09288
 -11.3548     16.1289    -0.854603      14.517     -0.769198   1.39571
  -0.681179   -0.854603   1.7804        -0.769198   1.60247    2.99776
  -6.76938     1.55068    3.3306         1.39571    2.99776    9.85162
   7.89293    -7.7744    -0.466389      -8.30307   -0.498104  -4.95003
  -7.7744     11.0431    -0.585128  …   11.794     -0.624918   1.13392
  -0.466389   -0.585128   1.219         -0.624918   1.30189    2.43546
  -4.63485     1.06172    2.28039        1.13392    2.43546    8.00374
   6.19064    -6.09767   -0.365801      -8.0243    -0.48138   -4.78383
  -6.09767     8.6614    -0.458932      11.3981    -0.603937   1.09585
   ⋮                                ⋱
  -6.36595     1.45827    3.13211        1.66804    3.58266   11.7738
   8.679      -8.54867   -0.512837     -11.2671    -0.67592   -6.71712
  -8.54867    12.1429    -0.643402      16.0043    -0.848005   1.53871
  -0.512837   -0.643402   1.3404        -0.848005   1.76665    3.30489
  -5.09644     1.16746    2.5075    …    1.53871    3.30489   10.861
  10.3759    -10.2201    -0.613105     -16.5687    -0.993962  -9.87773
 -10.2201     14.517     -0.769198      23.5349    -1.24702    2.26272
  -0.613105   -0.769198   1.60247       -1.24702    2.59791    4.85994
  -6.09288     1.39571    2.99776        2.26272    4.85994   15.9714

julia&gt; E = eigen(K)
Eigen{Float64,Float64,Kronecker.KroneckerProduct{Float64,Array{Float64,2},Array{Float64,2}},Array{Float64,1}}
values:
40-element Array{Float64,1}:
   7.865760357621699e-6
   0.00012816589015614754
   0.0016814634288020703
   0.003822939045482496
   0.00016583308589616827
   0.0027021094089942133
   0.0354501353387418
   0.08059866437337053
   0.0006487074126156292
   0.01057013679652864
   ⋮
  13.370524116745484
   0.031284413105262344
   0.5097529636487605
   6.687668341823235
  15.204938739231261
   0.4069949734492136
   6.63163771709009
  87.00330704812399
 197.80884549914757
vectors:
40×40 Kronecker.KroneckerProduct{Float64,Array{Float64,2},Array{Float64,2}}:
  0.138127   -0.107054      0.020968   …   0.0312014  -0.218073
  0.0804391  -0.090286      0.113445       0.168811    0.235113
 -0.120517   -0.181219     -0.0708265     -0.105393    0.0128798
  0.111275    0.0018835    -0.184744      -0.274908    0.114686
 -0.218256    0.169156     -0.0331317      0.023811   -0.16642
 -0.127102    0.142662     -0.179255   …   0.128826    0.179424
  0.190429    0.286346      0.111914      -0.0804298   0.00982905
 -0.175827   -0.00297613    0.291915      -0.209793    0.0875215
  0.221046   -0.171318      0.0335552      0.0217082  -0.151723
  0.128727   -0.144485      0.181546       0.117449    0.163578
  ⋮                                    ⋱
  0.0210899   0.000356978  -0.0350143     -0.312933    0.130549
 -0.133025    0.103099     -0.0201935      0.0307744  -0.215089
 -0.077468    0.0869512    -0.109254       0.166501    0.231896
  0.116065    0.174526      0.0682105     -0.103951    0.0127035
 -0.107165   -0.00181393    0.17792    …  -0.271146    0.113117
  0.220808   -0.171134      0.0335191      0.037312   -0.260782
  0.128589   -0.14433       0.181351       0.201872    0.281159
 -0.192656   -0.289694     -0.113222      -0.126034    0.0154022
  0.177883    0.00301093   -0.295329      -0.328748    0.137147

julia&gt; logdet(E)
-74.0191624933685

julia&gt; b = randn(40);

julia&gt; (E + 0.1I) \ b  # solve a system
40-element Array{Float64,1}:
   3.6188926463419744
   5.121510688722437
   8.01048321011603
   0.495472765176594
  -0.11233445342082331
  -5.67307152272965
 -11.15497537062587
   2.386207624364456
   3.433275595034983
  -3.725171179786487
   ⋮
   1.2518394144827096
 -11.020187723761955
  -6.02201295135513
  19.954589502530826
 -12.04922178338725
  -0.24226962120489384
   7.094543908027747
   1.7657771757482525
   2.340796748933226</code></pre><article class="docstring"><header><a class="docstring-binding" id="LinearAlgebra.eigen" href="#LinearAlgebra.eigen"><code>LinearAlgebra.eigen</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">eigen(K::AbstractKroneckerProduct)</code></pre><p>Wrapper around <code>eigen</code> from the <code>LinearAlgebra</code> package. If the matrices of an <code>AbstractKroneckerProduct</code> instance are square, performs Eigenvalue decompositon on them and returns an <code>Eigen</code> type. Otherwise, it collects the instance and runs eigen on the full matrix. The functions, <code>\</code>, <code>inv</code>, and <code>logdet</code> are overloaded to efficiently work with this type.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MichielStock/Kronecker.jl/blob/f5d0966f41d82287d5ee1e5d098dbd6f12b52446/src/eigen.jl#L5-L14">source</a></section></article><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>+(E::Eigen, B::UniformScaling)</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>+(::Eigen, ::UniformScaling)</code>. Check Documenter&#39;s build log for details.</p></div></div><article class="docstring"><header><a class="docstring-binding" id="LinearAlgebra.det-Tuple{Eigen{var&quot;#s5&quot;,var&quot;#s3&quot;,var&quot;#s2&quot;,U} where U&lt;:(AbstractArray{T,1} where T) where var&quot;#s2&quot;&lt;:AbstractKroneckerProduct where var&quot;#s3&quot;&lt;:Number where var&quot;#s5&quot;&lt;:Number}" href="#LinearAlgebra.det-Tuple{Eigen{var&quot;#s5&quot;,var&quot;#s3&quot;,var&quot;#s2&quot;,U} where U&lt;:(AbstractArray{T,1} where T) where var&quot;#s2&quot;&lt;:AbstractKroneckerProduct where var&quot;#s3&quot;&lt;:Number where var&quot;#s5&quot;&lt;:Number}"><code>LinearAlgebra.det</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">det(K::AbstractKroneckerProduct)</code></pre><p>Compute the determinant of a Kronecker product.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MichielStock/Kronecker.jl/blob/f5d0966f41d82287d5ee1e5d098dbd6f12b52446/src/base.jl#L206-L210">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LinearAlgebra.logdet-Tuple{Eigen{var&quot;#s5&quot;,var&quot;#s3&quot;,var&quot;#s2&quot;,U} where U&lt;:(AbstractArray{T,1} where T) where var&quot;#s2&quot;&lt;:AbstractKroneckerProduct where var&quot;#s3&quot;&lt;:Number where var&quot;#s5&quot;&lt;:Number}" href="#LinearAlgebra.logdet-Tuple{Eigen{var&quot;#s5&quot;,var&quot;#s3&quot;,var&quot;#s2&quot;,U} where U&lt;:(AbstractArray{T,1} where T) where var&quot;#s2&quot;&lt;:AbstractKroneckerProduct where var&quot;#s3&quot;&lt;:Number where var&quot;#s5&quot;&lt;:Number}"><code>LinearAlgebra.logdet</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">logdet(K::Eigen)</code></pre><p>Compute the logarithm of the determinant of the eigenvalue decomp of aKronecker product.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MichielStock/Kronecker.jl/blob/f5d0966f41d82287d5ee1e5d098dbd6f12b52446/src/eigen.jl#L46-L51">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.inv-Tuple{Eigen{var&quot;#s5&quot;,var&quot;#s3&quot;,var&quot;#s2&quot;,U} where U&lt;:(AbstractArray{T,1} where T) where var&quot;#s2&quot;&lt;:AbstractKroneckerProduct where var&quot;#s3&quot;&lt;:Number where var&quot;#s5&quot;&lt;:Number}" href="#Base.inv-Tuple{Eigen{var&quot;#s5&quot;,var&quot;#s3&quot;,var&quot;#s2&quot;,U} where U&lt;:(AbstractArray{T,1} where T) where var&quot;#s2&quot;&lt;:AbstractKroneckerProduct where var&quot;#s3&quot;&lt;:Number where var&quot;#s5&quot;&lt;:Number}"><code>Base.inv</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">inv(K::Eigen)</code></pre><p>Compute the inverse of the eigenvalue decomp of aKronecker product. Returns another type of <code>Eigen</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MichielStock/Kronecker.jl/blob/f5d0966f41d82287d5ee1e5d098dbd6f12b52446/src/eigen.jl#L54-L59">source</a></section></article><h2 id="Cholesky-factorization"><a class="docs-heading-anchor" href="#Cholesky-factorization">Cholesky factorization</a><a id="Cholesky-factorization-1"></a><a class="docs-heading-anchor-permalink" href="#Cholesky-factorization" title="Permalink"></a></h2><p>Similar to the eigenvalue decomposition, <code>cholesky</code> has been overloaded to allow for efficient Cholesky decomposition of Kronecker products of symmetric and positive definite matrices.</p><pre><code class="language-julia-repl">
julia&gt; A, B = rand(10, 10), randn(4, 4);

julia&gt; As, Bs = (A, B) .|&gt; X -&gt; X * X&#39;;  # make positive definite

julia&gt; K = As ⊗ Bs
40×40 Kronecker.KroneckerProduct{Float64,Array{Float64,2},Array{Float64,2}}:
  25.4759    -9.45283  -11.4418   -16.6137   …  -4.04113  -4.89141   -7.10243
  -9.45283   24.101    -11.4143    18.5797      10.3033   -4.87968    7.94291
 -11.4418   -11.4143    23.5464     3.84387     -4.87968  10.0662     1.64327
 -16.6137    18.5797     3.84387   23.595        7.94291   1.64327   10.087
  10.9086    -4.04765   -4.8993    -7.11389     -3.76977  -4.56295   -6.62551
  -4.04765   10.3199    -4.88756    7.95573  …   9.61142  -4.55201    7.40955
  -4.8993    -4.88756   10.0824     1.64592     -4.55201   9.39025    1.53293
  -7.11389    7.95573    1.64592   10.1033       7.40955   1.53293    9.40965
  15.6639    -5.81208   -7.03499  -10.2149      -4.78667  -5.79383   -8.41276
  -5.81208   14.8185    -7.01812   11.4238      12.2041   -5.77994    9.4083
   ⋮                                         ⋱
  -6.51293    7.28366    1.50688    9.24977      4.1455    0.857642   5.26451
  12.6251    -4.68454   -5.6702    -8.23325     -4.58759  -5.55285   -8.06285
  -4.68454   11.9437    -5.65661    9.20755     11.6965   -5.53953    9.01699
  -5.6702    -5.65661   11.6689     1.90491     -5.53953  11.4274     1.86548
  -8.23325    9.20755    1.90491   11.693    …   9.01699   1.86548   11.451
  10.8911    -4.04113   -4.89141   -7.10243     -4.41582  -5.34495   -7.76097
  -4.04113   10.3033    -4.87968    7.94291     11.2586   -5.33213    8.67939
  -4.89141   -4.87968   10.0662     1.64327     -5.33213  10.9995     1.79564
  -7.10243    7.94291    1.64327   10.087        8.67939   1.79564   11.0223

julia&gt; C = cholesky(K)
40×40 CholeskyKronecker{Cholesky{Float64,Array{Float64,2}},Cholesky{Float64,Array{Float64,2}}}
U factor:
40×40 Kronecker.KroneckerProduct{Float64,UpperTriangular{Float64,Array{Float64,2}},UpperTriangular{Float64,Array{Float64,2}}}:
 5.04736  -1.87283  -2.26688  …  -0.800641   -0.969102   -1.40716
 0.0       4.53801  -3.45081      1.94002    -1.47524     1.16958
 0.0       0.0       2.54942      0.0         1.08989     0.976462
 0.0       0.0       0.0          0.0         0.0         0.103674
 0.0      -0.0      -0.0         -0.530905   -0.642612   -0.933086
 0.0       0.0      -0.0      …   1.28643    -0.978231    0.775548
 0.0       0.0       0.0          0.0         0.722705    0.647493
 0.0       0.0       0.0          0.0         0.0         0.0687466
 0.0      -0.0      -0.0         -0.149377   -0.180807   -0.262535
 0.0       0.0      -0.0          0.361952   -0.275238    0.21821
 ⋮                            ⋱
 0.0       0.0       0.0         -0.0        -0.0        -0.00470684
 0.0      -0.0      -0.0         -0.198375   -0.240115   -0.348652
 0.0       0.0      -0.0          0.48068    -0.365521    0.289787
 0.0       0.0       0.0          0.0         0.270042    0.241939
 0.0       0.0       0.0      …   0.0         0.0         0.0256875
 0.0      -0.0      -0.0         -0.0114145  -0.0138162  -0.0200614
 0.0       0.0      -0.0          0.0276583  -0.021032    0.0166743
 0.0       0.0       0.0          0.0         0.0155382   0.0139211
 0.0       0.0       0.0          0.0         0.0         0.00147806

julia&gt; logdet(C)
-61.583716996791665

julia&gt; inv(C)
40×40 Kronecker.KroneckerProduct{Float64,Array{Float64,2},Array{Float64,2}}:
   2467.59    12443.0        …   -28654.9          30974.5
  12443.0     69368.1                -1.58114e5        1.75431e5
   8780.31    48448.5                -1.10893e5        1.22394e5
  -9491.06   -53754.7                 1.22394e5       -1.36612e5
  -4494.13   -22661.9             53658.4         -58001.9
 -22661.9        -1.26337e5  …   296079.0             -3.28507e5
 -15991.2    -88237.2                 2.07655e5       -2.29192e5
  17285.7     97901.3                -2.29192e5        2.55815e5
   -344.835   -1738.85             4089.44         -4420.48
  -1738.85    -9693.87            22564.9         -25036.3
      ⋮                      ⋱
 -32843.7        -1.86018e5           4.30052e5  -480006.0
   5701.99    28752.7            -67501.0          72965.1
  28752.7         1.60292e5          -3.72461e5        4.13254e5
  20289.1         1.11952e5          -2.61225e5        2.88319e5
 -21931.5        -1.24214e5  …        2.88319e5       -3.2181e5
  -8053.1    -40608.3             96012.8             -1.03785e5
 -40608.3        -2.26386e5           5.29785e5       -5.87809e5
 -28654.9        -1.58114e5           3.71564e5  -410102.0
  30974.5         1.75431e5     -410102.0              4.57739e5</code></pre><article class="docstring"><header><a class="docstring-binding" id="LinearAlgebra.cholesky" href="#LinearAlgebra.cholesky"><code>LinearAlgebra.cholesky</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">cholesky(K::AbstractKroneckerProduct; check = true)</code></pre><p>Wrapper around <code>cholesky</code> from the <code>LinearAlgebra</code> package. Performs Cholesky on the matrices of a <code>AbstractKroneckerProduct</code> instances and returns a <code>CholeskyKronecker</code> type. Similar to <code>Cholesky</code>, <code>size</code>, <code>\</code>, <code>inv</code>, <code>det</code>, and <code>logdet</code> are overloaded to efficiently work with this type.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MichielStock/Kronecker.jl/blob/f5d0966f41d82287d5ee1e5d098dbd6f12b52446/src/factorization.jl#L42-L49">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../multiplication/">« Multiplication</a><a class="docs-footer-nextpage" href="../indexed/">Indexed Kronecker products »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Saturday 13 March 2021 10:47">Saturday 13 March 2021</span>. Using Julia version 1.5.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
